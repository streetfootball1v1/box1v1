<style>
    /* Modal Styles */
    .modal-overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.85);
      backdrop-filter: blur(10px); z-index: 2000;
      display: none; align-items: center; justify-content: center;
      padding: 20px; transition: 0.4s var(--cubic);
    }
    .modal-overlay.active { display: flex; animation: fadeIn 0.3s forwards; }

    .modal-card {
      background: #111; width: 100%; max-width: 500px;
      border-radius: 32px; border: 1px solid var(--border);
      position: relative; padding: 40px;
      transform: translateY(20px); transition: 0.5s var(--cubic);
    }
    .modal-overlay.active .modal-card { transform: translateY(0); }

    .close-modal {
      position: absolute; top: 20px; right: 20px;
      width: 40px; height: 40px; background: var(--card);
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      cursor: pointer; border: 1px solid var(--border); color: #fff;
    }

    /* Stats Bars */
    .player-stats-grid { margin: 30px 0; display: grid; gap: 15px; }
    .stat-row { display: flex; align-items: center; justify-content: space-between; }
    .stat-bar-bg { width: 60%; height: 4px; background: #222; border-radius: 2px; overflow: hidden; position: relative; }
    .stat-bar-fill { height: 100%; background: var(--accent); border-radius: 2px; transition: 1s var(--cubic); width: 0; }
    .stat-label { font-size: 10px; font-weight: 800; text-transform: uppercase; color: var(--text-dim); }
    .stat-value { font-size: 12px; font-weight: 900; color: var(--accent); }

    .player-bio { font-size: 0.9rem; color: var(--text-dim); line-height: 1.5; margin-top: 20px; }
</style>

<div class="modal-overlay" id="playerModal" onclick="closePlayerModal(event)">
    <div class="modal-card" onclick="event.stopPropagation()">
        <div class="close-modal" onclick="closePlayerModal()">✕</div>
        <span class="label" id="m-role">Role</span>
        <h2 class="title-m" id="m-name" style="font-size: 3rem; margin-bottom: 10px;">NAME</h2>
        <div class="ovr-display" id="m-ovr" style="font-size: 4rem; margin-bottom: 20px;">00</div>
        
        <div class="player-stats-grid">
            <div class="stat-row">
                <span class="stat-label">Дриблинг</span>
                <div class="stat-bar-bg"><div class="stat-bar-fill" id="s-drib"></div></div>
                <span class="stat-value" id="v-drib">0</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Скорость</span>
                <div class="stat-bar-bg"><div class="stat-bar-fill" id="s-speed"></div></div>
                <span class="stat-value" id="v-speed">0</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Удар</span>
                <div class="stat-bar-bg"><div class="stat-bar-fill" id="s-shot"></div></div>
                <span class="stat-value" id="v-shot">0</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Физика</span>
                <div class="stat-bar-bg"><div class="stat-bar-fill" id="s-phys"></div></div>
                <span class="stat-value" id="v-phys">0</span>
            </div>
        </div>
        
        <p class="player-bio" id="m-bio"></p>
    </div>
</div>

<script>
    // Обновленные данные игроков с характеристиками
    const playersFullData = {
      'KUSCH': { 
        r: 78, role: 'Founder', 
        drib: 82, speed: 75, shot: 80, phys: 70,
        bio: 'Основатель лиги. Предпочитает техничный футбол на ограниченном пространстве. Мастер контроля темпа игры.' 
      },
      'ZUPAROV': { 
        r: 75, role: 'Core', 
        drib: 70, speed: 85, shot: 72, phys: 80,
        bio: 'Двигатель команды. Обладает взрывной скоростью и мощным корпусом. Неуступчив в единоборствах.' 
      },
      'DIDUR': { 
        r: 72, role: 'Scout', 
        drib: 88, speed: 70, shot: 65, phys: 60,
        bio: 'Главный по эстетике. Его дриблинг заставляет трибуны замирать. Видит поле на 360 градусов.' 
      },
      'BIBIKOV': { 
        r: 70, role: 'Support', 
        drib: 65, speed: 72, shot: 85, phys: 75,
        bio: 'Обладает самым пушечным ударом в лиге. Каждое касание — угроза воротам соперника.' 
      },
      'VARYUSHCHENKOV': { 
        r: 68, role: 'Rookie', 
        drib: 75, speed: 78, shot: 68, phys: 65,
        bio: 'Молодой талант с огромным потенциалом. Быстр, техничен и готов доказывать свое место в элите.' 
      }
    };

    function openPlayerModal(name) {
      const p = playersFullData[name];
      if(!p) return;

      document.getElementById('m-name').innerText = name;
      document.getElementById('m-role').innerText = p.role;
      document.getElementById('m-ovr').innerText = p.r;
      document.getElementById('m-bio').innerText = p.bio;

      // Заполняем бары
      const stats = { 'drib': p.drib, 'speed': p.speed, 'shot': p.shot, 'phys': p.phys };
      for (let s in stats) {
        document.getElementById(`s-${s}`).style.width = stats[s] + '%';
        document.getElementById(`v-${s}`).innerText = stats[s];
      }

      document.getElementById('playerModal').classList.add('active');
    }

    function closePlayerModal() {
      document.getElementById('playerModal').classList.remove('active');
      // Сбрасываем ширину баров для анимации при следующем открытии
      const bars = ['drib', 'speed', 'shot', 'phys'];
      bars.forEach(s => document.getElementById(`s-${s}`).style.width = '0%');
    }

    // Обнови функцию init(), чтобы карточки стали кликабельными
    function init() {
      document.getElementById('roster-grid').innerHTML = Object.keys(playersFullData).map(name => {
        const p = playersFullData[name];
        return `
          <div class="bento-item" onclick="openPlayerModal('${name}')">
            <span class="label">OVR ${p.r}</span>
            <h3 class="title-m" style="font-size:1.2rem">${name}</h3>
            <p style="margin-top: auto; font-size: 0.75rem; color: var(--text-dim);">${p.role}</p>
          </div>
        `;
      }).join('');

      // Код для таблицы рейтинга остается прежним, берем данные из Object.entries
      document.getElementById('stats-body').innerHTML = Object.entries(playersFullData)
        .sort((a,b) => b[1].r - a[1].r)
        .map(([name, p], i) => `
          <tr style="border-bottom: 1px solid var(--border)" onclick="openPlayerModal('${name}')">
            <td style="padding: 20px; font-style: italic; color: var(--text-dim)">#0${i+1}</td>
            <td style="padding: 20px; font-weight: 900; text-transform: uppercase;">${name}</td>
            <td style="padding: 20px; text-align: right; color: var(--accent); font-weight: 900;">${p.r}</td>
          </tr>
        `).join('');
    }
</script>

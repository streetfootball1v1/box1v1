<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>BOX1V1 | –¶–ò–§–†–û–í–ê–Ø –≠–ö–û–°–ò–°–¢–ï–ú–ê</title>
<meta name="description" content="BOX1V1 ‚Äî –∑–∞–∫—Ä—ã—Ç–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ñ—É—Ç–±–æ–ª–∏—Å—Ç–æ–≤ 1 –Ω–∞ 1. –¢–µ—Ö–Ω–∏–∫–∞, –º–µ–¥–∏–∞ –∏ —Å–∫–∞—É—Ç–∏–Ω–≥.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://box1v1.ru/">
<meta property="og:title" content="BOX1V1 | –¶–ò–§–†–û–í–ê–Ø –≠–ö–û–°–ò–°–¢–ï–ú–ê">
<meta property="og:description" content="–°—Ç–∞–Ω—å —á–∞—Å—Ç—å—é —ç–ª–∏—Ç–∞—Ä–Ω–æ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ —Ñ—É—Ç–±–æ–ª–∏—Å—Ç–æ–≤ 1x1. –†–µ–π—Ç–∏–Ω–≥–∏, –∫–∞—Ä—Ç–æ—á–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.">
<meta property="og:image" content="https://box1v1.ru/preview-og.jpg">

<!-- Preload –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet" media="print" onload="this.media='all'">

<!-- Inline critical CSS -->
<style>
/* CRITICAL CSS - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ */
:root {
  --bg: #ffffff;
  --bg-alt: #f8f8f8;
  --card: #ffffff;
  --text: #0a0a0a;
  --text-dim: #404040;
  --border: rgba(0,0,0,0.08);
  --accent: #15803d;
  --accent-light: #22c55e;
  --accent-dark: #166534;
  --ls-tight: -0.04em;
  --ls-normal: -0.01em;
  --lh-tight: 1.1;
  --lh-base: 1.6;
  --shadow-sm: 0 2px 8px rgba(0,0,0,0.06);
  --shadow-md: 0 20px 40px -12px rgba(0,0,0,0.12);
  --cubic: cubic-bezier(0.2, 0, 0, 1);
  --glass: rgba(255,255,255,0.9);
  --radius: 24px;
  --radius-sm: 14px;
}

* { 
  margin: 0; 
  padding: 0; 
  box-sizing: border-box; 
  -webkit-tap-highlight-color: transparent; 
}

html {
  scroll-behavior: smooth;
  background: var(--bg);
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  background: var(--bg);
  color: var(--text);
  overflow-x: hidden;
  line-height: var(--lh-base);
  letter-spacing: var(--ls-normal);
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
  :root {
    --bg: #0a0a0a;
    --bg-alt: #1a1a1a;
    --card: #1a1a1a;
    --text: #ffffff;
    --text-dim: #a0a0a0;
    --border: rgba(255,255,255,0.1);
    --glass: rgba(26,26,26,0.9);
  }
}

/* PRELOADER */
#preloader {
  position: fixed; 
  inset: 0; 
  background: var(--bg); 
  z-index: 9999;
  display: flex; 
  justify-content: center; 
  align-items: center;
  transition: opacity 0.8s var(--cubic), visibility 0.8s;
}
#preloader.loaded { 
  opacity: 0; 
  visibility: hidden; 
}

/* SKELETON LOADING STATES */
.skeleton {
  background: linear-gradient(90deg, 
    var(--bg-alt) 25%, 
    rgba(255,255,255,0.5) 50%, 
    var(--bg-alt) 75%
  );
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s infinite;
  border-radius: var(--radius);
}

.skeleton-text {
  height: 1em;
  margin-bottom: 0.5em;
  border-radius: 4px;
}

.skeleton-image {
  width: 100%;
  height: 200px;
  border-radius: var(--radius);
}

@keyframes skeleton-loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* NAVIGATION */
nav {
  position: fixed; 
  top: 0; 
  left: 0; 
  width: 100%; 
  height: 72px;
  background: var(--glass); 
  backdrop-filter: blur(24px);
  -webkit-backdrop-filter: blur(24px); 
  z-index: 1000;
  transition: 0.4s var(--cubic); 
  border-bottom: 1px solid transparent;
}
body.scrolled nav {
  border-bottom: 1px solid var(--border);
  background: rgba(255,255,255,0.97); 
  height: 64px;
}
@media (prefers-color-scheme: dark) {
  body.scrolled nav {
    background: rgba(26,26,26,0.97);
  }
}

.nav-inner {
  max-width: 1300px; 
  margin: 0 auto; 
  height: 100%;
  display: flex; 
  align-items: center; 
  justify-content: space-between; 
  padding: 0 32px;
}

.logo {
  font-size: 1.4rem; 
  font-weight: 900; 
  font-style: italic; 
  letter-spacing: -1px; 
  cursor: pointer;
  transition: 0.3s;
  color: var(--text);
}
.logo:hover { opacity: 0.7; }

/* Reduce motion */
@media (prefers-reduced-motion: reduce) {
  html { scroll-behavior: auto; }
  * { animation-duration: 0.01ms !important; }
}

/* –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ —Å–∫—Ä—ã—Ç—ã –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ */
.main-content { opacity: 0; }
.main-content.loaded { opacity: 1; transition: opacity 0.3s; }

@keyframes load { 
  0% { transform: translateX(-100%); } 
  100% { transform: translateX(100%); } 
}

/* MOBILE ADAPTIVITY FIXES */
@media (max-width: 768px) {
  .nav-inner { 
    padding: 0 16px; 
  }
  
  .main-content {
    padding: 100px 16px 60px;
  }
  
  /* –£–ª—É—á—à–∞–µ–º —Ç–∞—á-–æ–±–ª–∞—Å—Ç–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
  .btn, .card, .filter-btn, .nav-links a {
    min-height: 44px;
  }
  
  /* –£–ª—É—á—à–∞–µ–º –º–æ–±–∏–ª—å–Ω—ã–π drawer */
  .mobile-drawer {
    width: 85%;
    max-width: 320px;
    padding: 100px 24px 40px;
  }
  
  .mobile-drawer a {
    font-size: 2rem;
  }
}

/* Fix –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
@media (max-width: 360px) {
  .nav-inner { 
    padding: 0 12px; 
  }
  
  .main-content {
    padding: 90px 12px 40px;
  }
  
  .timer-context {
    padding: 20px 16px !important;
  }
  
  .mobile-drawer {
    width: 90%;
    padding: 100px 20px 40px;
  }
  
  .mobile-drawer a {
    font-size: 1.8rem;
  }
}
</style>

<!-- Deferred non-critical CSS -->
<link rel="stylesheet" href="styles.css" media="print" onload="this.media='all'">
<noscript><link rel="stylesheet" href="styles.css"></noscript>
</head>
<body>
<div id="toast-container"></div>

<div id="preloader" role="status" aria-label="–ó–∞–≥—Ä—É–∑–∫–∞">
  <div style="text-align:center;">
    <h2 style="font-size:3rem; margin-bottom:10px; color: var(--text);">BOX<span style="color:var(--accent)">1</span>V1</h2>
    <div style="width:140px; height:2px; background:var(--bg-alt); margin:0 auto; position:relative; overflow:hidden;">
      <div style="position:absolute; width:60%; height:100%; background:var(--text); animation: load 1.5s infinite var(--cubic);"></div>
    </div>
  </div>
</div>

<nav id="navbar">
  <div class="nav-inner">
    <div class="logo" onclick="switchTab('home')" aria-label="–ù–∞ –≥–ª–∞–≤–Ω—É—é" tabindex="0" role="button">BOX<span style="color:var(--accent)">1</span>V1</div>
    <div class="nav-links" role="navigation">
      <a href="#home" onclick="switchTab('home')" class="active" id="btn-home">–ì–ª–∞–≤–Ω–∞—è</a>
      <a href="#roster" onclick="switchTab('roster')" id="btn-roster">–£–ß–ê–°–¢–ù–ò–ö–ò</a>
      <a href="#stats" onclick="switchTab('stats')" id="btn-stats">–†–µ–π—Ç–∏–Ω–≥</a>
    </div>
    <button class="burger" id="burger" onclick="toggleMenu()" aria-label="–ú–µ–Ω—é" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>
  </div>
</nav>

<div class="drawer-overlay" id="drawer-overlay" onclick="toggleMenu()"></div>
<div class="mobile-drawer" id="mobile-drawer">
  <a href="#home" onclick="handleMobileNav('home')">–ì–ª–∞–≤–Ω–∞—è</a>
  <a href="#roster" onclick="handleMobileNav('roster')">–£–ß–ê–°–¢–ù–ò–ö–ò</a>
  <a href="#stats" onclick="handleMobileNav('stats')">–†–µ–π—Ç–∏–Ω–≥</a>
  <div style="margin-top:auto;">
    <button class="btn btn-primary" style="width:100%" onclick="handleMobileNav('applyModal', true)">–°—Ç–∞—Ç—å —á–∞—Å—Ç—å—é</button>
  </div>
</div>

<main class="main-content" id="main-content">
  <!-- –°–µ–∫—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è JavaScript -->
</main>

<!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
<div class="modal-overlay" id="playerModal" role="dialog" aria-modal="true" aria-label="–ö–∞—Ä—Ç–æ—á–∫–∞ –∏–≥—Ä–æ–∫–∞">
  <div class="modal-content">
    <button class="modal-close" onclick="closeModal('playerModal')" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
    <div id="m-img-container" style="width:100%; height:320px; border-radius:24px; overflow:hidden; background:#f0f0f0; margin-bottom:32px;">
      <img id="m-img" src="" style="width:100%; height:100%; object-fit:cover; display: none;" alt="–§–æ—Ç–æ –∏–≥—Ä–æ–∫–∞">
    </div>
    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
      <div>
        <span id="m-role" style="font-size:11px; font-weight:800; text-transform:uppercase; color:var(--accent-dark); background:rgba(34,197,94,0.1); padding:6px 12px; border-radius:10px;">ROLE</span>
        <h2 id="m-name" style="font-size: 2.5rem; margin-top:12px; color: var(--text);">NAME</h2>
        <div id="m-badges" style="display:flex; gap:8px; margin-top:16px; flex-wrap:wrap;"></div>
      </div>
      <div id="m-ovr" style="font-size: 3rem; font-weight:900; font-style:italic; line-height:1; letter-spacing:-3px; color: var(--text);">99</div>
    </div>
    <div id="m-stats" style="margin-top:40px; display:grid; grid-template-columns: 1fr 1fr; gap: 32px;"></div>
    <div style="margin-top:48px; display:flex; gap:12px; flex-wrap:wrap;">
      <button class="btn btn-primary" style="flex:1; min-width:140px;" onclick="copyPlayerID()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ID</button>
      <button class="btn btn-outline" style="flex:1; min-width:140px;" onclick="sharePlayer()">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
    </div>
  </div>
</div>

<div class="modal-overlay" id="applyModal" role="dialog" aria-modal="true">
  <div class="modal-content">
    <button class="modal-close" onclick="closeModal('applyModal')">‚úï</button>
    <h2 style="font-size:2rem; margin-bottom:20px; color: var(--text);">–í–°–¢–£–ü–ò–¢–¨ –í BOX1V1</h2>
    <p style="margin-bottom:32px; color: var(--text-dim);">–ß—Ç–æ–±—ã –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É, –æ—Å—Ç–∞–≤—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–¥ –ª—é–±—ã–º –ø–æ—Å—Ç–æ–º —Å —Ö–µ—à—Ç–µ–≥–æ–º #BOX–£–ß–ê–°–¢–í–û–í–ê–¢–¨.</p>
    <button class="btn btn-primary" style="width:100%; padding:24px;" onclick="window.open('https://t.me/streetbox1v1')">–û—Ç–∫—Ä—ã—Ç—å Telegram</button>
  </div>
</div>

<div class="modal-overlay" id="rulesModal" role="dialog" aria-modal="true">
  <div class="modal-content" style="max-width: 600px;">
    <button class="modal-close" onclick="closeModal('rulesModal')">‚úï</button>
    <h2 style="font-size:2rem; margin-bottom:32px; color: var(--text);">–†–ï–ì–õ–ê–ú–ï–ù–¢</h2>
    <div style="display:flex; flex-direction:column; gap:20px;">
      <div style="padding-bottom:15px; border-bottom:1px solid var(--border);">
        <strong style="text-transform:uppercase; font-size:12px; display:block; margin-bottom:4px; color:var(--accent)">01. –§–æ—Ä–º–∞—Ç</strong>
        <p style="font-size:15px; color:var(--text); font-weight:500;">–ú–∞—Ç—á–∏ 1 –Ω–∞ 1 —Å —É—á–∞—Å—Ç–∏–µ–º –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ –≤—Ä–∞—Ç–∞—Ä—è.</p>
      </div>
      <div style="padding-bottom:15px; border-bottom:1px solid var(--border);">
        <strong style="text-transform:uppercase; font-size:12px; display:block; margin-bottom:4px; color:var(--accent)">02. –¢–∞–π–º–∏–Ω–≥</strong>
        <p style="font-size:15px; color:var(--text); font-weight:500;">–õ–∏–º–∏—Ç –Ω–∞ –∞—Ç–∞–∫—É ‚Äî 20 —Å–µ–∫—É–Ω–¥.</p>
      </div>
      <div style="padding-bottom:15px; border-bottom:1px solid var(--border);">
        <strong style="text-transform:uppercase; font-size:12px; display:block; margin-bottom:4px; color:var(--accent)">03. –†–µ–∑—É–ª—å—Ç–∞—Ç</strong>
        <p style="font-size:15px; color:var(--text); font-weight:500;">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–≥—Ä—ã –¥–æ –¥–≤—É—Ö –≥–æ–ª–æ–≤, –±–µ–∑ –Ω–∏—á—å–∏.</p>
      </div>
    </div>
  </div>
</div>

<!-- –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç -->
<script>
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let allPlayers = [];
let currentRoleFilter = '–í—Å–µ';
let currentSort = { column: 'ovr', direction: 'desc' };
let renderTimeout;

// DICTIONARY FOR UX
const statDefs = {
  'DRI': '–¢–µ—Ö–Ω–∏–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –º—è—á–∞ –∏ –≤–µ–¥–µ–Ω–∏—è –¥—Ä–∏–±–ª–∏–Ω–≥–∞',
  'SPD': '–°—Ç–∞—Ä—Ç–æ–≤—ã–π —Ä—ã–≤–æ–∫ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è',
  'SHT': '–ú–æ—â–Ω–æ—Å—Ç—å –∏ —Ç–æ—á–Ω–æ—Å—Ç—å –∑–∞–≤–µ—Ä—à–∞—é—â–µ–≥–æ —É–¥–∞—Ä–∞',
  'PHY': '–§–∏–∑–∏—á–µ—Å–∫–∞—è –º–æ—â—å, –±–æ—Ä—å–±–∞ –∏ –∞—Ç–ª–µ—Ç–∏–∑–º',
  'REF': '–ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —É–¥–∞—Ä—ã –≤ —É–ø–æ—Ä',
  'DIV': '–î–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä—ã–∂–∫–∞ –∏ –æ—Ö–≤–∞—Ç —Å—Ç–≤–æ—Ä–∞ –≤–æ—Ä–æ—Ç',
  'HAN': '–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∏ –æ—Ç—Ä–∞–∂–µ–Ω–∏—è –º—è—á–∞',
  'POS': '–ì—Ä–∞–º–æ—Ç–Ω—ã–π –≤—ã–±–æ—Ä –ø–æ–∑–∏—Ü–∏–∏ –≤ —Å—Ç–≤–æ—Ä–µ –≤–æ—Ä–æ—Ç'
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
async function init() {
  try {
    const res = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vREjbeB6jNrU01kw1npVtFTvqGdP134ERjmyROoOYeYXbzjgL0ZCNK6KwF0VTk3c1yxZEZEUsJjy2Ur/pub?output=csv');
    if (!res.ok) throw new Error("Network response was not ok");
    
    const text = await res.text();
    allPlayers = parseCSV(text);
    
    if (allPlayers.length === 0) {
      showToast("–†–æ—Å—Ç–µ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ –ø—É—Å—Ç");
    }
    
    renderRealContent();
    handleHashAndDeepLink();
    setInterval(updateTimer, 1000);
    updateTimer();
    
    document.getElementById('preloader').classList.add('loaded');
    document.getElementById('main-content').classList.add('loaded');
    
  } catch (e) {
    console.error("Load Error", e);
    showToast("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö");
    document.getElementById('preloader').classList.add('loaded');
    document.getElementById('main-content').classList.add('loaded');
  }
}

// –ü–∞—Ä—Å–∏–Ω–≥ CSV
function parseCSV(text) {
  const rows = text.replace(/\r/g, '').split('\n').filter(r => r.trim());
  return rows.slice(1).map(row => {
    const matches = row.match(/(".*?"|[^",\n]+)(?=\s*,|\s*$)/g);
    const c = matches ? matches.map(m => m.replace(/^"|"$/g, '').trim()) : [];
    return {
      name: c[0] || '',
      ovr: parseInt(c[1]) || 0,
      role: c[2] || '–ò–≥—Ä–æ–∫',
      drib: parseInt(c[3]) || 0,
      speed: parseInt(c[4]) || 0,
      shot: parseInt(c[5]) || 0,
      phys: parseInt(c[6]) || 0,
      photo: c[7] || 'https://via.placeholder.com/400x600?text=No+Photo',
      status: c[8] || '',
      badges: c[9] ? c[9].split('|').map(b => b.trim()) : []
    };
  }).filter(p => p.name);
}

// –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
function renderRealContent() {
  const mainContent = document.getElementById('main-content');
  
  // –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
  const homeSection = `
    <section id="home" class="active">
      <div class="intro-block">
        <span style="font-size:12px; font-weight:800; text-transform:uppercase; letter-spacing:0.4em; color:var(--accent); display:block; margin-bottom:20px;">The Next Gen Football</span>
        <h1>BOX1V1.</h1>
        <p>–†–µ—à–∞–µ—Ç –Ω–µ –∫–æ–º–∞–Ω–¥–∞.<br>–†–µ—à–∞–µ—à—å —Ç—ã.</p>
        <div class="btn-group" style="display:flex; gap:16px; justify-content:center; flex-wrap:wrap;">
          <button class="btn btn-primary" onclick="switchTab('roster')">–£—á–∞—Å—Ç–Ω–∏–∫–∏</button>
          <button class="btn btn-outline" onclick="openModal('applyModal')">–ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É</button>
        </div>
        <div class="timer-context" id="timer-container">
          <span class="timer-label" id="timer-status">–î–æ —Å—Ç–∞—Ä—Ç–∞ —Å–µ–∑–æ–Ω–∞:</span>
          <div class="countdown" id="timer">
            <div><div class="countdown-value" id="days">00</div><div class="countdown-label">–¥–Ω</div></div>
            <div><div class="countdown-value" id="hours">00</div><div class="countdown-label">—á—Å</div></div>
            <div><div class="countdown-value" id="mins">00</div><div class="countdown-label">–º–∏–Ω</div></div>
            <div><div class="countdown-value" id="secs">00</div><div class="countdown-label">—Å–µ–∫</div></div>
          </div>
        </div>
      </div>
      <div class="bento-grid">
        <div class="card" style="grid-column: span 2; background: var(--bg-alt);" onclick="openModal('rulesModal')" tabindex="0">
          <span style="font-size:11px; font-weight:800; color:var(--accent-dark); text-transform:uppercase; letter-spacing:0.1em;">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</span>
          <h2 style="font-size: 3.5rem; margin: 20px 0 15px;">–†–ï–ì–õ–ê–ú–ï–ù–¢.</h2>
          <p>–°–≤–æ–¥ –ø—Ä–∞–≤–∏–ª –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –º–∞—Ç—á–µ–π.</p>
          <div style="margin-top: auto; padding-top: 30px; font-weight: 800; font-size: 12px; text-transform: uppercase;">–ò–∑—É—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ ‚Üí</div>
        </div>
        <div class="card" onclick="window.open('https://t.me/streetbox1v1')" tabindex="0">
          <h3 style="font-size: 1.8rem;">TELEGRAM</h3>
          <p style="font-size: 14px; margin-top: 8px;">–°–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.</p>
        </div>
        <div class="card" onclick="window.open('https://instagram.com/box.1v1')" tabindex="0">
          <h3 style="font-size: 1.8rem;">INSTAGRAM</h3>
          <p style="font-size: 14px; margin-top: 8px;">–ì–ª–∞–≤–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –≤ –º–µ–¥–∏–∞ —Ñ–æ—Ä–º–∞—Ç–µ.</p>
        </div>
      </div>
    </section>
  `;
  
  // –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
  const rosterSection = `
    <section id="roster">
      <div style="margin-bottom: 60px;">
        <h1 style="font-size: clamp(3rem, 10vw, 8rem);">–£–ß–ê–°–¢–ù–ò–ö–ò.</h1>
        <p style="font-size: 1.25rem;">–î–µ–π—Å—Ç–≤—É—é—â–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ BOX1V1.</p>
      </div>
      <div class="controls-row" style="margin-bottom: 40px; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:20px;">
        <input type="text" class="search-input" id="playerSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏..." oninput="debouncedRender()">
        <div class="filter-bar" style="display:flex; gap:8px;">
          <button class="filter-btn active" data-role="–í—Å–µ" onclick="setRoleFilter('–í—Å–µ', this)">–í—Å–µ</button>
          <button class="filter-btn" data-role="–ò–≥—Ä–æ–∫" onclick="setRoleFilter('–ò–≥—Ä–æ–∫', this)">–ü–æ–ª–µ–≤—ã–µ</button>
          <button class="filter-btn" data-role="–í—Ä–∞—Ç–∞—Ä—å" onclick="setRoleFilter('–í—Ä–∞—Ç–∞—Ä—å', this)">–í—Ä–∞—Ç–∞—Ä–∏</button>
        </div>
      </div>
      <div class="bento-grid" id="roster-grid"></div>
    </section>
  `;
  
  // –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞
  const statsSection = `
    <section id="stats">
      <h1 style="font-size: clamp(3rem, 10vw, 8rem); margin-bottom:40px;">–†–ï–ô–¢–ò–ù–ì.</h1>
      <div class="table-wrapper">
        <table role="grid">
          <thead>
            <tr>
              <th data-sort="rank" onclick="sortTable('rank')">#.</th>
              <th data-sort="name" onclick="sortTable('name')">–ò–≥—Ä–æ–∫</th>
              <th data-sort="ovr" onclick="sortTable('ovr')" style="text-align:right;">OVR —Ä–µ–π—Ç–∏–Ω–≥</th>
            </tr>
          </thead>
          <tbody id="stats-body"></tbody>
        </table>
      </div>
    </section>
  `;
  
  mainContent.innerHTML = homeSection + rosterSection + statsSection;
  
  // –†–µ–Ω–¥–µ—Ä–∏–º –¥–∞–Ω–Ω—ã–µ
  renderRoster();
  renderStats();
  
  // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
  setupEventListeners();
}

// –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function renderRoster() {
  const grid = document.getElementById('roster-grid');
  const search = document.getElementById('playerSearch').value.toLowerCase();
  const filtered = allPlayers.filter(p => {
    const mSearch = p.name.toLowerCase().includes(search);
    const mRole = currentRoleFilter === '–í—Å–µ' || p.role === currentRoleFilter;
    return mSearch && mRole;
  });
  
  if (filtered.length === 0) {
    grid.innerHTML = `<div style="grid-column: 1/-1; padding: 40px; text-align: center; color: var(--text-dim);">–ê—Ç–ª–µ—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>`;
    return;
  }
  
  grid.innerHTML = filtered.map((p, i) => `
    <div class="card player-card"
         tabindex="0"
         role="button"
         aria-label="–ü—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞ ${p.name}, —Ä–µ–π—Ç–∏–Ω–≥ ${p.ovr}, —Ä–æ–ª—å ${p.role}${p.badges[0] ? ', ' + p.badges[0] : ''}"
         style="animation: fadeInUp 0.6s var(--cubic) both ${i*0.03}s"
         onclick="openPlayerModal('${p.name.replace(/'/g, "\\'")}')"
         onkeydown="if(event.key==='Enter') openPlayerModal('${p.name.replace(/'/g, "\\'")}')">
      <div class="player-img" style="background-image: url('${p.photo}')"></div>
      ${p.status ? `<div style="position:absolute; top:32px; right:32px; z-index:3; background:var(--accent-light); color:#000; font-size:10px; font-weight:900; padding:6px 14px; border-radius:12px; text-transform:uppercase;">${p.status}</div>` : ''}
      <div class="player-info">
        <span style="font-size:11px; font-weight:800; text-transform:uppercase; color:var(--accent-light); letter-spacing:0.1em;">${p.role}</span>
        <h3 style="font-size:2.2rem; margin: 8px 0; color: #fff;">${p.name}</h3>
        ${p.badges.length > 0 ? `<div style="font-size:10px; color:rgba(255,255,255,0.7); margin-top:4px;">${p.badges[0]}</div>` : ''}
        <div class="ovr-badge">OVR ${p.ovr}</div>
      </div>
    </div>
  `).join('');
}

// –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–π—Ç–∏–Ω–≥–∞
function renderStats() {
  const sorted = [...allPlayers].sort((a, b) => {
    const multiplier = currentSort.direction === 'desc' ? -1 : 1;
    
    if (currentSort.column === 'name') {
      return multiplier * a.name.localeCompare(b.name);
    } else if (currentSort.column === 'ovr') {
      return multiplier * (b.ovr - a.ovr);
    } else if (currentSort.column === 'rank') {
      return multiplier * (allPlayers.indexOf(a) - allPlayers.indexOf(b));
    }
    return 0;
  });
  
  document.getElementById('stats-body').innerHTML = sorted.map((p, i) => `
    <tr onclick="openPlayerModal('${p.name.replace(/'/g, "\\'")}')" style="cursor:pointer" tabindex="0" onkeydown="if(event.key==='Enter') openPlayerModal('${p.name.replace(/'/g, "\\'")}')" aria-label="–†–µ–π—Ç–∏–Ω–≥ ${p.ovr}, ${p.name}, ${p.role}${p.badges[0] ? ', ' + p.badges[0] : ''}">
      <td style="font-weight:900; color:var(--text-dim)">${(i+1).toString().padStart(2, '0')}</td>
      <td>
        <div style="display:flex; align-items:center; gap:16px;">
          <img src="${p.photo}" style="width:48px; height:48px; border-radius:14px; object-fit:cover;" alt="">
          <div>
            <div style="font-weight:900; text-transform:uppercase; font-style:italic;">${p.name}</div>
            <div style="font-size:10px; font-weight:700; color:var(--text-dim); text-transform:uppercase;">${p.role}</div>
          </div>
        </div>
      </td>
      <td style="text-align:right;"><span class="ovr-badge">${p.ovr}</span></td>
    </tr>
  `).join('');
  
  // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
  updateSortHeaders();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
function updateSortHeaders() {
  const headers = document.querySelectorAll('th[data-sort]');
  headers.forEach(header => {
    const sortColumn = header.getAttribute('data-sort');
    header.classList.remove('sort-asc', 'sort-desc');
    
    if (sortColumn === currentSort.column) {
      header.classList.add(`sort-${currentSort.direction}`);
    }
  });
}

// –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã
function sortTable(column) {
  if (currentSort.column === column) {
    currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
  } else {
    currentSort = { column, direction: 'desc' };
  }
  
  renderStats();
}

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
function switchTab(id, updateHash = true) {
  const target = document.getElementById(id);
  if(!target) return;
  
  document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-links a').forEach(a => a.classList.remove('active'));
  
  target.classList.add('active');
  const btn = document.getElementById('btn-' + id);
  if(btn) btn.classList.add('active');
  
  if (updateHash) window.history.pushState(null, null, `#${id}`);
  window.scrollTo({top:0, behavior:'smooth'});
}

// –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–≥—Ä–æ–∫–∞
function openPlayerModal(name) {
  const p = allPlayers.find(x => x.name.toLowerCase() === name.toLowerCase());
  if(!p) {
    showToast("–ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω");
    return;
  }

  document.getElementById('m-name').innerText = p.name;
  document.getElementById('m-role').innerText = p.role;
  document.getElementById('m-ovr').innerText = p.ovr;
  
  const img = document.getElementById('m-img');
  const imgContainer = document.getElementById('m-img-container');
  
  // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ —Å –ø—Ä–µ–ª–æ–∞–¥–µ—Ä–æ–º
  img.style.display = 'none';
  imgContainer.style.background = '#f0f0f0';
  
  img.src = p.photo;
  img.alt = `–§–æ—Ç–æ –∏–≥—Ä–æ–∫–∞ ${p.name}`;
  
  img.onload = () => {
    img.style.display = 'block';
  };
  
  img.onerror = () => {
    imgContainer.style.background = 'var(--bg-alt)';
    imgContainer.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-dim);">–§–æ—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ</div>';
  };
  
  // –ë–µ–π–¥–∂–∏
  document.getElementById('m-badges').innerHTML = p.badges.map(b => `<span style="font-size:10px; background:var(--text); color:#fff; padding:4px 10px; border-radius:8px; font-weight:800;">${b}</span>`).join('');

  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  const isGK = p.role === '–í—Ä–∞—Ç–∞—Ä—å';
  const stats = [
    { l: isGK ? 'REF' : 'DRI', v: p.drib },
    { l: isGK ? 'DIV' : 'SPD', v: p.speed },
    { l: isGK ? 'HAN' : 'SHT', v: p.shot },
    { l: isGK ? 'POS' : 'PHY', v: p.phys }
  ];

  document.getElementById('m-stats').innerHTML = stats.map(s => `
    <div class="stat-item">
      <div style="display:flex; justify-content:space-between; margin-bottom:12px;">
        <div class="stat-header" data-tip="${statDefs[s.l]}">
          <span style="font-size:12px; font-weight:900;">${s.l}</span>
          <i class="info-icon">?</i>
        </div>
        <span style="font-size:12px; font-weight:900;">${s.v}</span>
      </div>
      <div style="height:4px; background:var(--bg-alt); border-radius:2px; overflow:hidden;">
        <div style="width:0%; height:100%; background:var(--text); transition:1.2s var(--cubic) 0.3s;" id="bar-${s.l}"></div>
      </div>
    </div>
  `).join('');

  openModal('playerModal');

  setTimeout(() => {
    stats.forEach(s => {
      const bar = document.getElementById(`bar-${s.l}`);
      if(bar) bar.style.width = s.v + '%';
    });
  }, 100);

  const currentTab = document.querySelector('section.active').id;
  const playerSlug = p.name.replace(/\s+/g, '-').toLowerCase();
  window.history.replaceState(null, null, `#${currentTab}?player=${playerSlug}`);
}

// –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ)
function openModal(id) {
  const lastFocusedElement = document.activeElement;
  const modal = document.getElementById(id);
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
  setTimeout(() => {
    const firstInput = modal.querySelector('button, input, [tabindex="0"]');
    if (firstInput) firstInput.focus();
  }, 100);
  modal.addEventListener('keydown', trapFocus);
}

function closeModal(id) {
  const modal = document.getElementById(id);
  if(!modal) return;
  modal.classList.remove('active');
  document.body.style.overflow = '';
  modal.removeEventListener('keydown', trapFocus);
  if (id === 'playerModal') {
    const currentTab = document.querySelector('section.active').id;
    window.history.replaceState(null, null, `#${currentTab}`);
  }
  if (lastFocusedElement) lastFocusedElement.focus();
}

function trapFocus(e) {
  if (e.key !== 'Tab') return;
  const focusableEls = this.querySelectorAll('button, [href], input, [tabindex="0"]');
  const first = focusableEls[0];
  const last = focusableEls[focusableEls.length - 1];
  if (e.shiftKey) {
    if (document.activeElement === first) { last.focus(); e.preventDefault(); }
  } else {
    if (document.activeElement === last) { first.focus(); e.preventDefault(); }
  }
}

function setRoleFilter(role, btn) {
  currentRoleFilter = role;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderRoster();
}

function toggleMenu() {
  const drawer = document.getElementById('mobile-drawer');
  const overlay = document.getElementById('drawer-overlay');
  const burger = document.getElementById('burger');
  const isOpen = drawer.classList.toggle('open');
  overlay.classList.toggle('open');
  burger.classList.toggle('open');
  burger.setAttribute('aria-expanded', isOpen);
}

function handleMobileNav(id, isModal = false) {
  toggleMenu();
  setTimeout(() => isModal ? openModal(id) : switchTab(id), 400);
}

function copyPlayerID() {
  const name = document.getElementById('m-name').innerText;
  navigator.clipboard.writeText(name).then(() => {
    showToast('ID –∏–≥—Ä–æ–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω');
  });
}

function sharePlayer() {
  const name = document.getElementById('m-name').innerText;
  const url = window.location.href;
  if(navigator.share) {
    navigator.share({
      title: 'BOX1V1 | ' + name,
      text: `–ö–∞—Ä—Ç–æ—á–∫–∞ –∞—Ç–ª–µ—Ç–∞ ${name} –≤ —Å–∏—Å—Ç–µ–º–µ BOX1V1! üî•`,
      url: url
    }).catch(() => {});
  } else {
    navigator.clipboard.writeText(url);
    showToast('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä');
  }
}

function updateTimer() {
  const TARGET_DATE = new Date("March 1, 2026 00:00:00").getTime();
  const now = Date.now();
  const diff = TARGET_DATE - now;
  const timerEl = document.getElementById('timer');
  if(diff <= 0) {
    document.getElementById('timer-status').innerText = "–°–µ–∑–æ–Ω –æ—Ç–∫—Ä—ã—Ç!";
    if(timerEl) timerEl.style.display = 'none';
    return;
  }
  document.getElementById('days').innerText = Math.floor(diff / 864e5).toString().padStart(2, '0');
  document.getElementById('hours').innerText = Math.floor((diff % 864e5) / 36e5).toString().padStart(2, '0');
  document.getElementById('mins').innerText = Math.floor((diff % 36e5) / 6e4).toString().padStart(2, '0');
  document.getElementById('secs').innerText = Math.floor((diff % 6e4) / 1000).toString().padStart(2, '0');
}

function showToast(message) {
  const container = document.getElementById('toast-container');
  const toast = document.createElement('div');
  toast.className = 'toast';
  toast.innerHTML = `<span>${message}</span>`;
  container.appendChild(toast);
  setTimeout(() => {
    toast.style.opacity = '0';
    toast.style.transform = 'translateY(20px)';
    setTimeout(() => toast.remove(), 500);
  }, 3000);
}

function handleHashAndDeepLink() {
  const fullHash = window.location.hash;
  if (!fullHash) return;
  const [hashPart, queryPart] = fullHash.split('?');
  const cleanHash = hashPart.replace('#', '');
  if (cleanHash && ['home', 'roster', 'stats'].includes(cleanHash)) {
    switchTab(cleanHash, false);
  }
  if (queryPart) {
    const params = new URLSearchParams(queryPart);
    const pNameFromUrl = params.get('player');
    if (pNameFromUrl) {
      const pName = pNameFromUrl.replace(/-/g, ' ');
      const found = allPlayers.find(x => x.name.toLowerCase() === pName.toLowerCase());
      if (found) setTimeout(() => openPlayerModal(found.name), 200);
    }
  }
}

function debouncedRender() {
  clearTimeout(renderTimeout);
  renderTimeout = setTimeout(renderRoster, 150);
}

function setupEventListeners() {
  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ Escape –¥–ª—è –º–æ–¥–∞–ª–æ–∫
  window.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      const activeModal = document.querySelector('.modal-overlay.active');
      if (activeModal) closeModal(activeModal.id);
    }
  });
  
  // –°–∫—Ä–æ–ª–ª –¥–ª—è navbar
  window.addEventListener('scroll', () => {
    document.body.classList.toggle('scrolled', window.scrollY > 50);
  });
}

// –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
document.addEventListener('DOMContentLoaded', init);
</script>

<!-- Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ -->
<noscript>
  <style>
    #preloader { display: none; }
    .main-content { opacity: 1; }
    .skeleton { background: var(--bg-alt); }
  </style>
  <p style="text-align:center; padding: 2rem; color: var(--text-dim);">
    –î–ª—è —Ä–∞–±–æ—Ç—ã —Å–∞–π—Ç–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è JavaScript. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∫–ª—é—á–∏—Ç–µ JavaScript –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞.
  </p>
</noscript>
</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover"/>
<meta name="theme-color" content="#0a0a0a">
<title>BOX1V1 | –£–õ–ò–ß–ù–´–ô –§–£–¢–ë–û–õ 1 –ù–ê 1</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
:root {
  --bg: #fafafa;
  --bg-elevated: #ffffff;
  --text: #0a0a0a;
  --text-secondary: #374151;
  --text-tertiary: #6b7280;
  --accent: #22c55e;
  --accent-dark: #16a34a;
  --border: rgba(0,0,0,0.08);
  --border-strong: rgba(0,0,0,0.15);
  --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  --nav-h: 72px;
  --radius: 24px;
  --radius-sm: 14px;
  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
  --safe-right: env(safe-area-inset-right);
  --ease-out: cubic-bezier(0.2, 0, 0, 1);
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
}

@media (max-width: 420px) { :root { --nav-h: 64px; } }

*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

html { scroll-behavior: smooth; background: var(--bg); -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; }

body { font-family: var(--font-sans); background: var(--bg); color: var(--text); line-height: 1.6; overflow-x: hidden; min-height: 100vh; min-height: 100dvh; }

h1, h2, h3 { font-weight: 900; font-style: italic; letter-spacing: -0.03em; line-height: 1.1; text-transform: uppercase; }

.skip-link { position: absolute; top: -40px; left: 0; background: var(--text); color: white; padding: 8px; text-decoration: none; z-index: 10000; transition: top 0.3s; }
.skip-link:focus { top: 0; }

/* PRELOADER */
#preloader { position: fixed; inset: 0; background: var(--bg); z-index: 9999; display: flex; justify-content: center; align-items: center; transition: opacity 0.6s var(--ease-out), visibility 0.6s; }
#preloader.loaded { opacity: 0; visibility: hidden; pointer-events: none; }
.preloader-content { text-align: center; padding: 20px; }
.preloader-logo { font-size: clamp(2rem, 8vw, 3rem); font-weight: 900; font-style: italic; letter-spacing: -0.05em; margin-bottom: 1.5rem; animation: pulse 2s infinite; }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
.loading-bar { width: 160px; height: 3px; background: rgba(0,0,0,0.05); border-radius: 3px; overflow: hidden; margin: 0 auto; position: relative; }
.loading-bar::after { content: ''; position: absolute; left: -50%; width: 50%; height: 100%; background: var(--text); animation: load 1.2s infinite ease-in-out; border-radius: 3px; }
@keyframes load { 0% { left: -50%; } 100% { left: 100%; } }

/* SKELETON LOADING */
.skeleton { background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%); background-size: 200% 100%; animation: shimmer-bg 1.5s infinite; border-radius: 8px; }
@keyframes shimmer-bg { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

/* ERROR STATES */
.error-container { grid-column: 1/-1; text-align: center; padding: 60px 20px; }
.error-title { font-size: 1.25rem; color: var(--text); margin-bottom: 12px; font-weight: 700; }
.error-message { font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 24px; }
.error-retry { background: none; border: 1.5px solid var(--border-strong); padding: 12px 24px; border-radius: 12px; cursor: pointer; font-family: inherit; font-weight: 600; transition: all 0.2s; }
.error-retry:hover { background: var(--text); color: white; border-color: var(--text); }

/* TOASTS */
#toast-container { position: fixed; bottom: max(24px, calc(var(--safe-bottom) + 8px)); left: 50%; transform: translateX(-50%); z-index: 10001; display: flex; flex-direction: column; gap: 10px; pointer-events: none; width: calc(100% - 40px); max-width: 400px; }
.toast { background: rgba(0,0,0,0.9); backdrop-filter: blur(12px); color: #fff; padding: 16px 24px; border-radius: 16px; font-size: 14px; font-weight: 600; box-shadow: 0 20px 40px rgba(0,0,0,0.2); animation: toastIn 0.4s var(--ease-spring) forwards; pointer-events: auto; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
@keyframes toastIn { from { opacity: 0; transform: translateY(20px) scale(0.9); } to { opacity: 1; transform: translateY(0) scale(1); } }

/* NAVIGATION */
nav { position: fixed; top: 0; left: 0; width: 100%; height: calc(var(--nav-h) + var(--safe-top)); padding-top: var(--safe-top); background: rgba(255,255,255,0.85); backdrop-filter: blur(20px) saturate(180%); z-index: 1000; border-bottom: 1px solid var(--border); transition: background 0.3s, box-shadow 0.3s; }
nav.scrolled { background: rgba(255,255,255,0.95); box-shadow: 0 4px 30px rgba(0,0,0,0.05); }
.nav-inner { max-width: 1300px; margin: 0 auto; height: var(--nav-h); display: flex; align-items: center; justify-content: space-between; padding: 0 max(20px, var(--safe-left)) 0 max(20px, var(--safe-right)); }

.logo { font-size: 1.5rem; font-weight: 900; font-style: italic; letter-spacing: -0.03em; cursor: pointer; transition: opacity 0.2s; text-decoration: none; color: var(--text); padding: 8px 0; display: flex; align-items: center; gap: 0; }
.logo:hover { opacity: 0.7; }
.logo:active { opacity: 0.5; }
.logo-accent { color: var(--accent); }

.nav-links { display: flex; gap: 8px; }
.nav-links a { display: inline-flex; align-items: center; justify-content: center; text-decoration: none; font-size: 12px; font-weight: 700; letter-spacing: 0.05em; text-transform: uppercase; color: var(--text-secondary); padding: 10px 20px; border-radius: var(--radius-sm); transition: all 0.2s var(--ease-out); min-height: 44px; border: 1px solid transparent; position: relative; overflow: hidden; }
.nav-links a:hover, .nav-links a:focus { color: var(--text); background: rgba(0,0,0,0.03); transform: translateY(-1px); }
.nav-links a:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
.nav-links a.active { color: #fff; background: var(--text); border-color: var(--text); }

/* BURGER */
.burger { display: none; cursor: pointer; width: 48px; height: 48px; flex-direction: column; justify-content: center; align-items: center; gap: 5px; border-radius: 14px; background: rgba(0,0,0,0.03); border: none; transition: all 0.3s var(--ease-out); position: relative; }
.burger:hover { background: rgba(0,0,0,0.06); transform: scale(1.05); }
.burger:active { transform: scale(0.95); }
.burger span { width: 22px; height: 2px; background: var(--text); border-radius: 2px; transition: all 0.3s var(--ease-spring); transform-origin: center; }
.burger.open span:nth-child(1) { transform: translateY(7px) rotate(45deg); }
.burger.open span:nth-child(2) { opacity: 0; transform: scaleX(0); }
.burger.open span:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }

/* DRAWER */
.drawer-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(8px); z-index: 1999; opacity: 0; visibility: hidden; transition: all 0.4s var(--ease-out); }
.drawer-overlay.open { opacity: 1; visibility: visible; }

.mobile-drawer { position: fixed; top: 0; right: -100%; width: min(86%, 380px); height: 100%; height: 100dvh; background: var(--bg-elevated); z-index: 2000; padding: calc(var(--safe-top) + 20px) 24px calc(var(--safe-bottom) + 24px); display: flex; flex-direction: column; gap: 8px; transition: right 0.5s var(--ease-spring); box-shadow: -20px 0 60px rgba(0,0,0,0.15); overflow-y: auto; overscroll-behavior: contain; }

.mobile-drawer-header { margin-bottom: 32px; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
.mobile-drawer .logo { font-size: 1.75rem; }
.mobile-drawer .logo-accent { color: var(--accent); }

.mobile-drawer.open { right: 0; }
.mobile-drawer a { font-size: 1.75rem; font-weight: 900; text-decoration: none; color: var(--text); font-style: italic; text-transform: uppercase; letter-spacing: -0.03em; padding: 16px 0; border-bottom: 1px solid var(--border); transition: all 0.2s; opacity: 0; transform: translateX(20px); }
.mobile-drawer.open a { opacity: 1; transform: translateX(0); }
.mobile-drawer.open a:nth-child(2) { transition-delay: 0.1s; }
.mobile-drawer.open a:nth-child(3) { transition-delay: 0.15s; }
.mobile-drawer.open a:nth-child(4) { transition-delay: 0.2s; }
.mobile-drawer a:hover, .mobile-drawer a:focus { color: var(--accent-dark); padding-left: 8px; }
.mobile-drawer .btn-group { margin-top: auto; padding-top: 32px; }

/* MAIN */
.main-content { max-width: 1300px; margin: 0 auto; padding: calc(var(--nav-h) + var(--safe-top) + 20px) max(20px, var(--safe-left)) calc(100px + var(--safe-bottom)) max(20px, var(--safe-right)); min-height: 100vh; min-height: 100dvh; }

section { display: none; opacity: 0; animation: fadeIn 0.6s var(--ease-out) forwards; }
section.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

/* INTRO */
.intro-block { padding: 60px 0 100px; text-align: center; max-width: 900px; margin: 0 auto; }
.intro-block span { display: block; font-size: 12px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.2em; color: var(--accent-dark); margin-bottom: 24px; opacity: 0; animation: fadeInUp 0.6s 0.2s forwards; }
.intro-block h1 { font-size: clamp(3rem, 12vw, 9rem); margin-bottom: 24px; opacity: 0; animation: fadeInUp 0.6s 0.3s forwards; line-height: 0.9; }
.intro-block p { font-size: clamp(1.125rem, 2.5vw, 1.5rem); color: var(--text-secondary); max-width: 500px; margin: 0 auto 40px; opacity: 0; animation: fadeInUp 0.6s 0.4s forwards; }
@keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

.btn-group { display: flex; gap: 16px; justify-content: center; flex-wrap: wrap; opacity: 0; animation: fadeInUp 0.6s 0.5s forwards; }

/* BUTTONS */
.btn { padding: 18px 32px; border-radius: 18px; font-weight: 700; text-transform: uppercase; font-size: 13px; letter-spacing: 0.03em; cursor: pointer; transition: all 0.25s var(--ease-out); border: none; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; gap: 10px; position: relative; overflow: hidden; min-height: 56px; min-width: 140px; user-select: none; -webkit-touch-callout: none; }
.btn-primary { background: var(--text); color: #fff; box-shadow: 0 4px 20px rgba(0,0,0,0.15); }
.btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(0,0,0,0.2); }
.btn-primary:active { transform: translateY(0); box-shadow: 0 2px 10px rgba(0,0,0,0.15); }
.btn-outline { background: transparent; border: 1.5px solid var(--border-strong); color: var(--text); }
.btn-outline:hover { background: rgba(0,0,0,0.02); border-color: var(--text); transform: translateY(-2px); }
.btn-outline:active { background: rgba(0,0,0,0.05); transform: translateY(0); }

@media (hover: none) and (pointer: coarse) {
  .btn:hover { transform: none !important; }
  .btn:active { transform: scale(0.98) !important; opacity: 0.9; }
}

/* STATUS CONTEXT (replaces timer) */
.status-context { margin-top: 60px; padding: 28px 48px; background: linear-gradient(135deg, rgba(34,197,94,0.08) 0%, rgba(34,197,94,0.02) 100%); border-radius: 24px; display: inline-flex; flex-direction: column; align-items: center; gap: 12px; border: 1px solid rgba(34,197,94,0.2); box-shadow: 0 4px 20px rgba(0,0,0,0.03); opacity: 0; animation: fadeInUp 0.6s 0.6s forwards; flex-wrap: wrap; justify-content: center; text-align: center; }
.status-label { font-size: 12px; font-weight: 800; color: var(--accent-dark); text-transform: uppercase; letter-spacing: 0.15em; }
.status-text { font-size: clamp(1.25rem, 3vw, 1.5rem); font-weight: 800; color: var(--text); line-height: 1.2; }
.status-hint { font-size: 0.9rem; color: var(--text-secondary); margin-top: 4px; }
.beta-badge { display: inline-block; background: rgba(34,197,94,0.15); color: var(--accent-dark); font-size: 10px; font-weight: 800; padding: 4px 8px; border-radius: 12px; margin-left: 8px; text-transform: uppercase; letter-spacing: 0.05em; vertical-align: middle; }

/* BENTO */
.bento-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px; margin-top: 40px; }
.card { background: var(--bg-elevated); border-radius: var(--radius); border: 1px solid var(--border); padding: 40px; position: relative; overflow: hidden; transition: all 0.4s var(--ease-out); cursor: pointer; display: flex; flex-direction: column; gap: 16px; contain: layout paint; content-visibility: auto; contain-intrinsic-size: 0 500px; }
@media (hover: hover) { .card:hover { transform: translateY(-4px); border-color: var(--border-strong); box-shadow: 0 20px 40px -12px rgba(0,0,0,0.1); } }
.card:active { transform: scale(0.99); }
.card:focus-visible { outline: 2px solid var(--accent); outline-offset: 4px; }
.card h2 { font-size: clamp(2rem, 4vw, 3.5rem); line-height: 1; }
.card h3 { font-size: 1.5rem; line-height: 1.2; }
.card p { color: var(--text-secondary); font-size: 0.95rem; line-height: 1.5; }

/* PLAYER CARDS */
.player-card { min-height: 480px; background: #000; color: #fff; border: none; padding: 32px; isolation: isolate; position: relative; }
.player-img { position: absolute; inset: 0; background-size: cover; background-position: center top; filter: grayscale(1); opacity: 0.4; transition: all 1s var(--ease-out); z-index: 0; background-color: #1a1a1a; }
.player-img::after { content: ''; position: absolute; inset: 0; background: linear-gradient(to top, #000 0%, rgba(0,0,0,0.6) 50%, transparent 100%); z-index: 1; }
@media (hover: hover) { .player-card:hover .player-img { filter: grayscale(0); opacity: 0.6; transform: scale(1.05); } }
.player-card::after { content: ''; position: absolute; inset: 0; background: linear-gradient(to top, #000 0%, rgba(0,0,0,0.6) 50%, transparent 100%); z-index: 1; }
.player-info { position: relative; z-index: 2; margin-top: auto; display: flex; flex-direction: column; gap: 8px; }
.player-info span { font-size: 11px; font-weight: 800; text-transform: uppercase; color: var(--accent); letter-spacing: 0.15em; }
.player-info h3 { font-size: clamp(1.75rem, 4vw, 2.2rem); overflow-wrap: break-word; hyphens: auto; word-break: break-word; }
.player-badges { font-size: 11px; color: rgba(255,255,255,0.7); margin-top: 4px; }
.ovr-badge { display: inline-flex; align-items: center; padding: 6px 14px; background: var(--accent); color: #000; border-radius: 12px; font-weight: 900; font-size: 12px; margin-top: 12px; width: fit-content; box-shadow: 0 4px 12px rgba(34,197,94,0.3); position: relative; }

/* TABLE */
.table-wrapper { background: var(--bg-elevated); border-radius: var(--radius); border: 1px solid var(--border); overflow: hidden; overflow-x: auto; -webkit-overflow-scrolling: touch; position: relative; }
table { width: 100%; border-collapse: collapse; min-width: 400px; }
th { text-align: left; padding: 24px; font-size: 11px; font-weight: 800; text-transform: uppercase; color: var(--text-tertiary); letter-spacing: 0.1em; border-bottom: 1px solid var(--border); white-space: nowrap; }
td { padding: 20px 24px; border-bottom: 1px solid var(--border); transition: background 0.2s; vertical-align: middle; }
tr:last-child td { border-bottom: none; }
tbody tr { cursor: pointer; transition: background 0.2s; }
tbody tr:hover, tbody tr:focus-within { background: rgba(0,0,0,0.02); }
tbody tr:focus-visible { outline: 2px solid var(--accent); outline-offset: -2px; }

.player-row { display: flex; align-items: center; gap: 16px; }
.player-avatar-sm { width: 48px; height: 48px; border-radius: 14px; object-fit: cover; background: var(--bg); flex-shrink: 0; }
.player-info-sm { display: flex; flex-direction: column; gap: 4px; min-width: 0; }
.player-name-sm { font-weight: 800; text-transform: uppercase; font-style: italic; letter-spacing: -0.02em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.player-role-sm { font-size: 11px; font-weight: 700; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.05em; }

/* MODAL */
.modal-overlay { position: fixed; inset: 0; background: rgba(255,255,255,0.8); backdrop-filter: blur(24px) saturate(180%); z-index: 3000; display: flex; justify-content: center; align-items: center; padding: 20px; opacity: 0; visibility: hidden; transition: all 0.4s var(--ease-out); overflow-y: auto; }
.modal-overlay.active { opacity: 1; visibility: visible; }

.modal-content { background: var(--bg-elevated); width: 100%; max-width: 520px; border-radius: 32px; padding: 48px; position: relative; max-height: 90vh; max-height: 90dvh; overflow-y: auto; box-shadow: 0 40px 80px -20px rgba(0,0,0,0.2); transform: translateY(40px) scale(0.95); transition: transform 0.5s var(--ease-spring); border: 1px solid var(--border); }

.modal-header-fixed { position: absolute; top: 16px; right: 16px; left: 16px; display: flex; justify-content: space-between; pointer-events: none; z-index: 10; }
.modal-header-fixed > button { pointer-events: auto; position: static !important; }

.modal-close, .download-circle { width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; border: none; transition: all 0.3s; background: rgba(0,0,0,0.03); color: var(--text-secondary); }
.modal-close { order: 2; }
.download-circle { order: 1; margin-right: auto; margin-left: 0; background: rgba(0,0,0,0.03); border: 1px solid var(--border); color: var(--text); }
.modal-close:hover, .modal-close:focus { background: rgba(0,0,0,0.08); color: var(--text); transform: rotate(90deg); }
.download-circle:hover, .download-circle:focus { background: var(--text); color: #fff; border-color: var(--text); transform: scale(1.1); }
.modal-close:focus-visible, .download-circle:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }

.modal-overlay.active .modal-content { transform: translateY(0) scale(1); }

#m-img-container { width: 100%; aspect-ratio: 1 / 1; max-height: 320px; border-radius: 20px; overflow: hidden; background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%); background-size: 200% 100%; animation: shimmer-bg 1.5s infinite; margin-bottom: 32px; margin-top: 60px; position: relative; }
#m-img { width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 0.4s; }
#m-img.loaded { opacity: 1; animation: none; }

.modal-header { display: flex; justify-content: space-between; align-items: flex-start; gap: 16px; margin-bottom: 32px; }
.modal-title-group { flex: 1; min-width: 0; }
#m-role { display: inline-block; font-size: 11px; font-weight: 800; text-transform: uppercase; color: var(--accent-dark); background: rgba(34,197,94,0.1); padding: 8px 14px; border-radius: 20px; margin-bottom: 12px; letter-spacing: 0.1em; }
#m-name { font-size: clamp(1.75rem, 5vw, 2.5rem); line-height: 1.1; overflow-wrap: break-word; hyphens: auto; }
#m-badges { display: flex; gap: 8px; margin-top: 16px; flex-wrap: wrap; }
.badge { font-size: 10px; font-weight: 800; background: var(--text); color: #fff; padding: 6px 12px; border-radius: 20px; text-transform: uppercase; letter-spacing: 0.05em; }
#m-ovr { font-size: clamp(2.5rem, 6vw, 3.5rem); font-weight: 900; font-style: italic; line-height: 1; letter-spacing: -0.05em; color: var(--text); flex-shrink: 0; text-align: right; }
.ovr-sub { font-size: 0.3em; display: block; font-weight: 600; opacity: 0.6; font-style: normal; letter-spacing: 0; margin-top: 4px; }

#m-stats { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; margin-bottom: 32px; }
.stat-item { position: relative; }
.stat-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; gap: 8px; }
.stat-label-group { display: flex; align-items: center; gap: 8px; cursor: help; position: relative; padding: 4px 0; }
.stat-label { font-size: 13px; font-weight: 800; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em; }
.stat-value { font-size: 13px; font-weight: 900; color: var(--text); }
.info-icon { width: 18px; height: 18px; border-radius: 50%; border: 1.5px solid var(--border-strong); display: flex; align-items: center; justify-content: center; font-size: 10px; color: var(--text-tertiary); font-style: normal; font-weight: 800; flex-shrink: 0; transition: all 0.2s; }
.stat-label-group:hover .info-icon, .stat-label-group:focus .info-icon { background: var(--text); color: #fff; border-color: var(--text); }

.stat-label-group[data-tooltip]::before { content: attr(data-tooltip); position: absolute; bottom: calc(100% + 10px); left: 50%; transform: translateX(-50%) translateY(8px); background: rgba(0,0,0,0.9); color: #fff; padding: 10px 16px; border-radius: 12px; font-size: 12px; font-weight: 500; line-height: 1.4; opacity: 0; visibility: hidden; transition: all 0.3s var(--ease-out); z-index: 100; pointer-events: none; white-space: nowrap; max-width: 260px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
.stat-label-group[data-tooltip]::after { content: ''; position: absolute; bottom: calc(100% + 4px); left: 50%; transform: translateX(-50%) translateY(8px); border: 6px solid transparent; border-top-color: rgba(0,0,0,0.9); opacity: 0; visibility: hidden; transition: all 0.3s var(--ease-out); }
.stat-label-group:hover[data-tooltip]::before, .stat-label-group:hover[data-tooltip]::after, .stat-label-group:focus[data-tooltip]::before, .stat-label-group:focus[data-tooltip]::after { opacity: 1; visibility: visible; transform: translateX(-50%) translateY(0); }

@media (max-width: 768px) {
  .stat-label-group[data-tooltip]::before { position: fixed; left: 50% !important; top: auto !important; bottom: 150px !important; transform: translateX(-50%) !important; max-width: calc(100vw - 40px); white-space: normal; z-index: 10000; }
  .stat-label-group[data-tooltip]::after { display: none; }
}

.stat-bar-bg { height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; position: relative; }
.stat-bar-fill { height: 100%; background: var(--text); border-radius: 3px; width: 0%; transition: width 1.2s var(--ease-out) 0.3s; position: relative; overflow: hidden; }
.stat-bar-fill::after { content: ''; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); animation: shimmer-bar 2s infinite; }
@keyframes shimmer-bar { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }

/* CONTROLS */
.controls-row { margin-bottom: 40px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px; }
.search-input { padding: 16px 24px; border-radius: 16px; border: 1.5px solid var(--border); background: var(--bg-elevated); width: 100%; max-width: 360px; font-family: inherit; font-size: 15px; font-weight: 500; transition: all 0.2s; color: var(--text); }
.search-input:hover { border-color: var(--border-strong); }
.search-input:focus { outline: none; border-color: var(--text); background: #fff; box-shadow: 0 0 0 4px rgba(0,0,0,0.04); }
.search-input::placeholder { color: var(--text-tertiary); }
.filter-bar { display: flex; gap: 8px; flex-wrap: wrap; }
.filter-btn { padding: 12px 20px; border-radius: 12px; border: 1px solid var(--border); background: var(--bg-elevated); font-size: 12px; font-weight: 700; cursor: pointer; text-transform: uppercase; letter-spacing: 0.03em; white-space: nowrap; transition: all 0.2s; color: var(--text-secondary); min-height: 44px; }
.filter-btn:hover { border-color: var(--border-strong); color: var(--text); transform: translateY(-1px); }
.filter-btn.active { background: var(--text); color: #fff; border-color: var(--text); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
.filter-btn:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }

/* SCROLLBAR */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border-strong); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: var(--text-tertiary); }

/* MOBILE */
@media (max-width: 1024px) { .bento-grid { grid-template-columns: repeat(2, 1fr); } }

@media (max-width: 768px) {
  .nav-links { display: none; }
  .burger { display: flex; }
  .main-content { padding-left: max(16px, var(--safe-left)); padding-right: max(16px, var(--safe-right)); }
  .intro-block { padding: 40px 0 60px; }
  .status-context { border-radius: 24px; flex-direction: column; gap: 16px; width: 100%; padding: 24px; }
  .btn { padding: 16px 24px; min-height: 52px; width: 100%; max-width: 300px; }
  .btn-group { flex-direction: column; align-items: center; }
  .bento-grid { grid-template-columns: 1fr; gap: 16px; }
  .card { padding: 28px; }
  .card[style*="grid-column: span 2"] { grid-column: span 1 !important; }
  .player-card { min-height: 360px; }
  .controls-row { flex-direction: column; align-items: stretch; }
  .search-input { max-width: 100%; }
  .filter-bar { overflow-x: auto; padding-bottom: 8px; flex-wrap: nowrap; -webkit-overflow-scrolling: touch; scrollbar-width: none; }
  .filter-bar::-webkit-scrollbar { display: none; }
  .filter-btn { flex-shrink: 0; }
  
  .modal-content { padding: 24px; border-radius: 24px; margin: 10px; width: calc(100% - 20px); max-height: 95vh; max-height: 95dvh; }
  .modal-header-fixed { top: 12px; right: 12px; left: 12px; }
  .modal-close, .download-circle { width: 40px; height: 40px; }
  .modal-close svg, .download-circle svg { width: 18px; height: 18px; }
  #m-img-container { aspect-ratio: 4 / 3; margin-top: 56px; }
  #m-stats { grid-template-columns: 1fr; gap: 20px; }
  th, td { padding: 16px 12px; }
  .player-avatar-sm { width: 40px; height: 40px; }
}

@media (max-width: 360px) {
  .intro-block h1 { font-size: 2.5rem; }
  .card h2 { font-size: 1.75rem; }
  .modal-close, .download-circle { width: 36px; height: 36px; }
}

/* –°–∫—Ä—ã—Ç—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ */
#screenshot-container { position: fixed; top: -9999px; left: -9999px; width: 520px; z-index: -1; pointer-events: none; opacity: 0; }
#screenshot-container .modal-content { position: static; max-height: none; overflow: visible; transform: none; margin: 0; box-shadow: none; border: 1px solid #eee; }
#screenshot-container .modal-header-fixed { display: none; }
#screenshot-container #m-img-container { margin-top: 0; }

/* Accessibility improvements */
:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
button:focus-visible, a:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; }
  html { scroll-behavior: auto; }
}
</style>
</head>
<body>
<a href="#main" class="skip-link">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É</a>

<div id="preloader" role="status" aria-label="–ó–∞–≥—Ä—É–∑–∫–∞">
  <div class="preloader-content">
    <div class="preloader-logo">BOX<span class="logo-accent">1</span>V1</div>
    <div class="loading-bar" aria-hidden="true"></div>
    <p style="margin-top: 16px; font-size: 13px; color: var(--text-secondary);" id="loading-status">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
  </div>
</div>

<div id="toast-container" role="region" aria-live="polite" aria-atomic="true"></div>

<nav id="navbar" role="navigation" aria-label="–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é">
  <div class="nav-inner">
    <a href="#home" class="logo" onclick="App.switchTab('home'); return false;" aria-label="BOX1V1 - –ù–∞ –≥–ª–∞–≤–Ω—É—é">
      BOX<span class="logo-accent">1</span>V1
    </a>
    <div class="nav-links">
      <a href="#home" onclick="App.switchTab('home'); return false;" id="btn-home" class="active" aria-current="page">–ì–ª–∞–≤–Ω–∞—è</a>
      <a href="#roster" onclick="App.switchTab('roster'); return false;" id="btn-roster">–£—á–∞—Å—Ç–Ω–∏–∫–∏</a>
      <a href="#stats" onclick="App.switchTab('stats'); return false;" id="btn-stats">–†–µ–π—Ç–∏–Ω–≥</a>
    </div>
    <button class="burger" id="burger" onclick="App.toggleMenu()" aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é" aria-expanded="false" aria-controls="mobile-drawer">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </button>
  </div>
</nav>

<div class="drawer-overlay" id="drawer-overlay" onclick="App.toggleMenu()" aria-hidden="true"></div>
<div class="mobile-drawer" id="mobile-drawer" role="dialog" aria-label="–ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é" aria-modal="true">
  <div class="mobile-drawer-header">
    <a href="#home" class="logo" onclick="App.handleMobileNav('home'); return false;">
      BOX<span class="logo-accent">1</span>V1
    </a>
  </div>
  <a href="#home" onclick="App.handleMobileNav('home'); return false;">–ì–ª–∞–≤–Ω–∞—è</a>
  <a href="#roster" onclick="App.handleMobileNav('roster'); return false;">–£—á–∞—Å—Ç–Ω–∏–∫–∏</a>
  <a href="#stats" onclick="App.handleMobileNav('stats'); return false;">–†–µ–π—Ç–∏–Ω–≥</a>
  <div class="btn-group">
    <button class="btn btn-primary" onclick="App.handleMobileNav('applyModal', true)" style="width:100%">–°—Ç–∞—Ç—å —á–∞—Å—Ç—å—é</button>
  </div>
</div>

<main id="main" class="main-content">
  <section id="home" class="active" aria-label="–ì–ª–∞–≤–Ω–∞—è">
    <div class="intro-block">
      <span>The Next Gen Football</span>
      <h1>BOX1V1.</h1>
      <p>–†–µ—à–∞–µ—Ç –Ω–µ –∫–æ–º–∞–Ω–¥–∞.<br>–†–µ—à–∞–µ—à—å —Ç—ã.</p>
      <div class="btn-group">
        <button class="btn btn-primary" onclick="App.switchTab('roster')">–£—á–∞—Å—Ç–Ω–∏–∫–∏</button>
        <button class="btn btn-outline" onclick="App.openModal('applyModal')">–ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É</button>
      </div>
      
      <!-- –ß–µ—Å—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å –≤–º–µ—Å—Ç–æ —Ñ–µ–π–∫–æ–≤–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞ -->
      <div class="status-context" id="status-container">
        <span class="status-label">–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞</span>
        <div class="status-text">
          üî• –ù–∞–±–æ—Ä —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ—Ç–∫—Ä—ã—Ç
          <span class="beta-badge">Beta</span>
        </div>
        <p class="status-hint">–ü–µ—Ä–≤—ã–π —Å–µ–∑–æ–Ω —Å—Ç–∞—Ä—Ç—É–µ—Ç –ø–æ—Å–ª–µ –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏–∏ –≥—Ä—É–ø–ø. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏.</p>
      </div>
    </div>
    
    <div class="bento-grid">
      <div class="card" style="grid-column: span 2;" onclick="App.openModal('rulesModal')" tabindex="0" role="button" aria-label="–û—Ç–∫—Ä—ã—Ç—å —Ä–µ–≥–ª–∞–º–µ–Ω—Ç">
        <span style="font-size:11px; font-weight:800; color:var(--accent-dark); text-transform:uppercase; letter-spacing:0.1em;">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</span>
        <h2>–†–ï–ì–õ–ê–ú–ï–ù–¢.</h2>
        <p>–°–≤–æ–¥ –ø—Ä–∞–≤–∏–ª –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –º–∞—Ç—á–µ–π.</p>
        <div style="margin-top:auto; padding-top:30px; font-weight:800; font-size:12px; text-transform:uppercase; color:var(--text-secondary);">–ò–∑—É—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ ‚Üí</div>
      </div>
      <div class="card" onclick="window.open('https://t.me/streetbox1v1', '_blank')" tabindex="0" role="link" aria-label="–û—Ç–∫—Ä—ã—Ç—å Telegram">
        <h3>TELEGRAM</h3>
        <p>–°–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.</p>
      </div>
      <div class="card" onclick="window.open('https://instagram.com/box.1v1', '_blank')" tabindex="0" role="link" aria-label="–û—Ç–∫—Ä—ã—Ç—å Instagram">
        <h3>INSTAGRAM</h3>
        <p>–ì–ª–∞–≤–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –≤ –º–µ–¥–∏–∞ —Ñ–æ—Ä–º–∞—Ç–µ.</p>
      </div>
    </div>
  </section>

  <section id="roster" aria-label="–£—á–∞—Å—Ç–Ω–∏–∫–∏">
    <div style="margin-bottom: 60px;">
      <h1 style="font-size: clamp(3rem, 10vw, 8rem); line-height:0.9;">–£–ß–ê–°–¢–ù–ò–ö–ò<span class="beta-badge" style="font-size: 0.15em; vertical-align: super;">–ü—Ä–µ–¥–≤.</span></h1>
      <p style="font-size: 1.25rem; margin-top:16px;">–î–µ–π—Å—Ç–≤—É—é—â–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ BOX1V1.</p>
    </div>
    <div class="controls-row">
      <input type="search" class="search-input" id="playerSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏..." aria-label="–ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞" autocomplete="off">
      <div class="filter-bar" role="group" aria-label="–§–∏–ª—å—Ç—Ä –ø–æ —Ä–æ–ª–∏">
        <button class="filter-btn active" data-role="–í—Å–µ" aria-pressed="true">–í—Å–µ</button>
        <button class="filter-btn" data-role="–ò–≥—Ä–æ–∫" aria-pressed="false">–ü–æ–ª–µ–≤—ã–µ</button>
        <button class="filter-btn" data-role="–í—Ä–∞—Ç–∞—Ä—å" aria-pressed="false">–í—Ä–∞—Ç–∞—Ä–∏</button>
      </div>
    </div>
    <div class="bento-grid" id="roster-grid" role="region" aria-live="polite" aria-label="–°–µ—Ç–∫–∞ –∏–≥—Ä–æ–∫–æ–≤">
      <!-- Skeleton loading -->
      <div class="card player-card skeleton" style="grid-column: span 1;">
        <div style="position: absolute; inset: 0; background: #1a1a1a;"></div>
      </div>
      <div class="card player-card skeleton" style="grid-column: span 1;">
        <div style="position: absolute; inset: 0; background: #1a1a1a;"></div>
      </div>
      <div class="card player-card skeleton" style="grid-column: span 1;">
        <div style="position: absolute; inset: 0; background: #1a1a1a;"></div>
      </div>
    </div>
  </section>

  <section id="stats" aria-label="–†–µ–π—Ç–∏–Ω–≥">
    <h1 style="font-size: clamp(3rem, 10vw, 8rem); margin-bottom:40px; line-height:0.9;">–†–ï–ô–¢–ò–ù–ì<span class="beta-badge" style="font-size: 0.15em; vertical-align: super;">–ü—Ä–µ–¥–≤.</span></h1>
    <div class="table-wrapper" role="region" aria-label="–¢–∞–±–ª–∏—Ü–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞" tabindex="0">
      <table role="table" aria-label="–†–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤">
        <thead>
          <tr>
            <th scope="col" aria-label="–ü–æ–∑–∏—Ü–∏—è">#</th>
            <th scope="col">–ò–≥—Ä–æ–∫</th>
            <th scope="col" style="text-align:right;">OVR</th>
          </tr>
        </thead>
        <tbody id="stats-body">
          <tr>
            <td colspan="3" style="text-align: center; padding: 40px;">
              <div class="skeleton" style="height: 40px; width: 100%; max-width: 200px; margin: 0 auto;"></div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>
</main>

<!-- Player Modal -->
<div class="modal-overlay" id="playerModal" role="dialog" aria-modal="true" aria-labelledby="m-name" onclick="if(event.target === this) App.closeModal('playerModal')">
  <div class="modal-content" id="stats-card" onclick="event.stopPropagation()">
    <div class="modal-header-fixed">
      <button id="download-card" class="download-circle" aria-label="–°–∫–∞—á–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –∏–≥—Ä–æ–∫–∞">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="7 10 12 15 17 10"></polyline>
          <line x1="12" y1="15" x2="12" y2="3"></line>
        </svg>
      </button>
      <button class="modal-close" onclick="App.closeModal('playerModal')" aria-label="–ó–∞–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –∏–≥—Ä–æ–∫–∞">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    
    <div id="m-img-container">
      <img id="m-img" src="" alt="–§–æ—Ç–æ –∏–≥—Ä–æ–∫–∞" loading="lazy">
    </div>
    
    <div class="modal-header">
      <div class="modal-title-group">
        <span id="m-role">ROLE</span>
        <h2 id="m-name">NAME</h2>
        <div id="m-badges" role="list" aria-label="–ë–µ–π–¥–∂–∏ –∏–≥—Ä–æ–∫–∞"></div>
      </div>
      <div id="m-ovr" aria-label="–û–±—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥">99</div>
    </div>
    
    <div id="m-stats" role="region" aria-label="–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–∞"></div>
    
    <div style="display:flex; gap:12px; flex-wrap:wrap;">
      <button class="btn btn-primary" style="flex:1; min-width:140px;" onclick="App.copyPlayerID()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ID</button>
      <button class="btn btn-outline" style="flex:1; min-width:140px;" onclick="App.sharePlayer()">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
    </div>
  </div>
</div>

<div class="modal-overlay" id="applyModal" role="dialog" aria-modal="true" aria-labelledby="apply-title" onclick="if(event.target === this) App.closeModal('applyModal')">
  <div class="modal-content" onclick="event.stopPropagation()">
    <div class="modal-header-fixed">
      <button class="modal-close" onclick="App.closeModal('applyModal')" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <h2 id="apply-title" style="font-size:1.75rem; margin:60px 0 16px; line-height:1.2;">–í–°–¢–£–ü–ò–¢–¨ –í BOX1V1</h2>
    <p style="margin-bottom:32px; color:var(--text-secondary); line-height:1.6;">–ß—Ç–æ–±—ã –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É, –æ—Å—Ç–∞–≤—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–¥ –ª—é–±—ã–º –ø–æ—Å—Ç–æ–º —Å —Ö–µ—à—Ç–µ–≥–æ–º <strong style="color:var(--text);">#BOX–£–ß–ê–°–¢–í–û–í–ê–¢–¨</strong>.</p>
    <button class="btn btn-primary" style="width:100%;" onclick="window.open('https://t.me/streetbox1v1', '_blank')">–û—Ç–∫—Ä—ã—Ç—å Telegram</button>
  </div>
</div>

<div class="modal-overlay" id="rulesModal" role="dialog" aria-modal="true" aria-labelledby="rules-title" onclick="if(event.target === this) App.closeModal('rulesModal')">
  <div class="modal-content" onclick="event.stopPropagation()">
    <div class="modal-header-fixed">
      <button class="modal-close" onclick="App.closeModal('rulesModal')" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <h2 id="rules-title" style="font-size:1.75rem; margin:60px 0 32px; line-height:1.2;">–†–ï–ì–õ–ê–ú–ï–ù–¢</h2>
    <div style="display:flex; flex-direction:column; gap:24px;">
      <article style="padding-bottom:24px; border-bottom:1px solid var(--border);">
        <h3 style="font-size:12px; font-weight:800; text-transform:uppercase; color:var(--accent-dark); margin-bottom:8px; letter-spacing:0.1em;">01. –§–æ—Ä–º–∞—Ç</h3>
        <p style="color:var(--text-secondary); line-height:1.6; margin:0;">–ú–∞—Ç—á–∏ 1 –Ω–∞ 1 —Å —É—á–∞—Å—Ç–∏–µ–º –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ –≤—Ä–∞—Ç–∞—Ä—è.</p>
      </article>
      <article style="padding-bottom:24px; border-bottom:1px solid var(--border);">
        <h3 style="font-size:12px; font-weight:800; text-transform:uppercase; color:var(--accent-dark); margin-bottom:8px; letter-spacing:0.1em;">02. –¢–∞–π–º–∏–Ω–≥</h3>
        <p style="color:var(--text-secondary); line-height:1.6; margin:0;">–õ–∏–º–∏—Ç –Ω–∞ –∞—Ç–∞–∫—É ‚Äî 20 —Å–µ–∫—É–Ω–¥.</p>
      </article>
      <article>
        <h3 style="font-size:12px; font-weight:800; text-transform:uppercase; color:var(--accent-dark); margin-bottom:8px; letter-spacing:0.1em;">03. –†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p style="color:var(--text-secondary); line-height:1.6; margin:0;">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–≥—Ä—ã –¥–æ –¥–≤—É—Ö –≥–æ–ª–æ–≤, –±–µ–∑ –Ω–∏—á—å–∏.</p>
      </article>
    </div>
  </div>
</div>

<div id="screenshot-container" aria-hidden="true"></div>

<script>
// –ú–æ–¥—É–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
const App = (function() {
  'use strict';
  
  // –ü—Ä–∏–≤–∞—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  const state = {
    players: [],
    filter: '–í—Å–µ',
    searchQuery: '',
    isLoading: false,
    error: null,
    currentModal: null,
    lastFocused: null
  };

  const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vREjbeB6jNrU01kw1npVtFTvqGdP134ERjmyROoOYeYXbzjgL0ZCNK6KwF0VTk3c1yxZEZEUsJjy2Ur/pub?output=csv';
  
  // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
  const CONFIG = {
    ENABLE_TIMER: false,
    SHOW_PRELIMINARY_BADGE: true,
    STRICT_VALIDATION: true
  };

  // XSS –∑–∞—â–∏—Ç–∞
  const escapeHTML = (str) => {
    if (!str) return '';
    const div = document.createElement('div');
    div.textContent = str;
    return div.innerHTML;
  };

  // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
  const validatePlayer = (data) => {
    const required = ['name', 'ovr', 'role'];
    for (const field of required) {
      if (!data[field] || (field === 'ovr' && isNaN(parseInt(data[field])))) {
        console.warn(`Invalid player data, missing ${field}:`, data);
        return false;
      }
    }
    if (data.name.length > 50) data.name = data.name.substring(0, 50);
    if (data.role.length > 20) data.role = data.role.substring(0, 20);
    return true;
  };

  // Focus Trap –¥–ª—è –º–æ–¥–∞–ª–æ–∫
  const initFocusTrap = (modal) => {
    const focusableElements = modal.querySelectorAll(
      'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
    );
    if (focusableElements.length === 0) return () => {};
    
    const firstFocusable = focusableElements[0];
    const lastFocusable = focusableElements[focusableElements.length - 1];

    const trap = (e) => {
      if (e.key !== 'Tab') return;
      
      if (e.shiftKey) {
        if (document.activeElement === firstFocusable) {
          lastFocusable.focus();
          e.preventDefault();
        }
      } else {
        if (document.activeElement === lastFocusable) {
          firstFocusable.focus();
          e.preventDefault();
        }
      }
    };

    modal.addEventListener('keydown', trap);
    return () => modal.removeEventListener('keydown', trap);
  };

  // DOM Helper
  const createEl = (tag, classes = '', attrs = {}, text = '') => {
    const el = document.createElement(tag);
    if (classes) el.className = classes;
    Object.entries(attrs).forEach(([k, v]) => el.setAttribute(k, v));
    if (text) el.textContent = text;
    return el;
  };

  // Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  const showToast = (message, duration = 3000) => {
    const container = document.getElementById('toast-container');
    if (!container) return;
    
    const toast = createEl('div', 'toast', { role: 'status' }, message);
    container.appendChild(toast);
    
    setTimeout(() => {
      toast.style.opacity = '0';
      toast.style.transform = 'translateY(20px)';
      setTimeout(() => toast.remove(), 500);
    }, duration);
  };

  // –ü–∞—Ä—Å–µ—Ä CSV (—É–ª—É—á—à–µ–Ω–Ω—ã–π)
  const parseCSV = (text) => {
    const lines = text.split('\n').filter(l => l.trim());
    if (lines.length < 2) return [];
    
    const players = [];
    
    for (let i = 1; i < lines.length; i++) {
      const line = lines[i];
      // –ü—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∞–≤—ã—á–µ–∫
      const values = [];
      let current = '';
      let inQuotes = false;
      
      for (let j = 0; j < line.length; j++) {
        const char = line[j];
        const nextChar = line[j + 1];
        
        if (char === '"') {
          if (inQuotes && nextChar === '"') {
            current += '"';
            j++;
          } else {
            inQuotes = !inQuotes;
          }
        } else if (char === ',' && !inQuotes) {
          values.push(current.trim());
          current = '';
        } else {
          current += char;
        }
      }
      values.push(current.trim());
      
      const player = {
        name: values[0] || '',
        ovr: parseInt(values[1]) || 0,
        role: values[2] || '–ò–≥—Ä–æ–∫',
        drib: parseInt(values[3]) || 0,
        speed: parseInt(values[4]) || 0,
        shot: parseInt(values[5]) || 0,
        phys: parseInt(values[6]) || 0,
        photo: values[7] || '',
        status: values[8] || '',
        badges: values[9] ? values[9].split('|').map(b => b.trim()).filter(Boolean) : []
      };
      
      if (validatePlayer(player)) {
        players.push(player);
      }
    }
    return players;
  };

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  const init = async () => {
    const preloader = document.getElementById('preloader');
    const loadingStatus = document.getElementById('loading-status');
    
    try {
      const controller = new AbortController();
      const timeoutId = setTimeout(() => {
        controller.abort();
        throw new Error('Timeout');
      }, 10000);
      
      const response = await fetch(CSV_URL, { 
        signal: controller.signal,
        headers: { 'Accept': 'text/csv' }
      });
      
      clearTimeout(timeoutId);
      
      if (!response.ok) throw new Error(`HTTP ${response.status}`);
      
      const text = await response.text();
      state.players = parseCSV(text);
      
      if (state.players.length === 0) {
        throw new Error('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –∏–≥—Ä–æ–∫–∞—Ö');
      }
      
      render();
      setupEventListeners();
      setupDownloadButton();
      
      setTimeout(() => preloader?.classList.add('loaded'), 500);
      
    } catch (error) {
      console.error('Init error:', error);
      if (loadingStatus) loadingStatus.textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
      showErrorUI(error.message === 'Timeout' ? '–ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è' : error.message);
      preloader?.classList.add('loaded');
    }
  };

  // UI –û—à–∏–±–æ–∫
  const showErrorUI = (message) => {
    const grid = document.getElementById('roster-grid');
    const tbody = document.getElementById('stats-body');
    
    const errorContent = `
      <div class="error-container">
        <div class="error-title">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</div>
        <div class="error-message">${escapeHTML(message)}</div>
        <button class="error-retry" onclick="location.reload()">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
        <p style="margin-top: 16px; font-size: 12px; color: var(--text-tertiary);">
          –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –Ω–∞–ø–∏—à–∏—Ç–µ –≤ <a href="https://t.me/streetbox1v1" style="color: var(--accent);">Telegram</a>
        </p>
      </div>
    `;
    
    if (grid) grid.innerHTML = errorContent;
    if (tbody) tbody.innerHTML = `<tr><td colspan="3" style="text-align: center; padding: 40px;">${escapeHTML(message)}</td></tr>`;
  };

  // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ä–æ—Å—Ç–µ—Ä–∞ —Å DocumentFragment
  const renderRoster = () => {
    const grid = document.getElementById('roster-grid');
    if (!grid) return;
    
    const filtered = state.players.filter(p => {
      const matchesSearch = p.name.toLowerCase().includes(state.searchQuery);
      const matchesRole = state.filter === '–í—Å–µ' || p.role === state.filter;
      return matchesSearch && matchesRole;
    });
    
    grid.innerHTML = '';
    
    if (filtered.length === 0) {
      const empty = createEl('div', '', { 
        style: 'grid-column: 1/-1; text-align: center; padding: 60px 20px;' 
      });
      empty.innerHTML = `
        <p style="font-size: 1.125rem; color: var(--text-secondary);">–ê—Ç–ª–µ—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
        <p style="font-size: 0.875rem; color: var(--text-tertiary); margin-top: 8px;">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
      `;
      grid.appendChild(empty);
      return;
    }
    
    const fragment = document.createDocumentFragment();
    
    filtered.forEach((p, index) => {
      const card = createEl('div', 'card player-card', {
        tabindex: '0',
        role: 'button',
        'aria-label': `–ö–∞—Ä—Ç–æ—á–∫–∞ –∏–≥—Ä–æ–∫–∞ ${escapeHTML(p.name)}`,
        style: `animation: fadeIn 0.5s ${index * 0.05}s forwards; opacity: 0;`
      });
      
      const imgDiv = createEl('div', 'player-img', { 'aria-hidden': 'true' });
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å fallback
      if (p.photo) {
        const tempImg = new Image();
        tempImg.onload = () => { imgDiv.style.backgroundImage = `url('${escapeHTML(p.photo)}')`; };
        tempImg.onerror = () => { imgDiv.style.backgroundColor = '#1a1a1a'; };
        tempImg.src = p.photo;
      }
      
      card.appendChild(imgDiv);
      
      if (p.status) {
        const status = createEl('div', '', {
          style: 'position:absolute; top:24px; right:24px; z-index:3; background:var(--accent); color:#000; font-size:11px; font-weight:900; padding:6px 14px; border-radius:20px; text-transform:uppercase;'
        });
        status.textContent = p.status;
        card.appendChild(status);
      }
      
      const info = createEl('div', 'player-info');
      const role = createEl('span', '', {}, p.role);
      const name = createEl('h3', '', {}, p.name);
      
      info.appendChild(role);
      info.appendChild(name);
      
      if (p.badges.length > 0) {
        const badges = createEl('div', 'player-badges', {}, p.badges[0]);
        info.appendChild(badges);
      }
      
      const ovr = createEl('span', 'ovr-badge', {}, `OVR ${p.ovr}`);
      if (CONFIG.SHOW_PRELIMINARY_BADGE) {
        ovr.title = '–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥';
      }
      
      info.appendChild(ovr);
      card.appendChild(info);
      
      card.addEventListener('click', () => openPlayerModal(p.name));
      card.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          openPlayerModal(p.name);
        }
      });
      
      fragment.appendChild(card);
    });
    
    grid.appendChild(fragment);
  };

  // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–∞–±–ª–∏—Ü—ã
  const renderStats = () => {
    const tbody = document.getElementById('stats-body');
    if (!tbody) return;
    
    const sorted = [...state.players].sort((a, b) => b.ovr - a.ovr);
    tbody.innerHTML = '';
    
    const fragment = document.createDocumentFragment();
    
    sorted.forEach((p, i) => {
      const tr = createEl('tr', '', { tabindex: '0', role: 'button' });
      tr.style.animation = `fadeIn 0.3s ${i * 0.03}s forwards`;
      tr.style.opacity = '0';
      
      tr.addEventListener('click', () => openPlayerModal(p.name));
      tr.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') openPlayerModal(p.name);
      });
      
      const tdPos = createEl('td', '', { 
        style: 'font-weight:800; color:var(--text-tertiary); font-variant-numeric: tabular-nums;' 
      }, (i + 1).toString().padStart(2, '0'));
      
      const tdPlayer = createEl('td');
      const row = createEl('div', 'player-row');
      
      const img = createEl('img', 'player-avatar-sm', {
        alt: '',
        loading: 'lazy',
        decoding: 'async'
      });
      
      // Fallback –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
      img.onerror = function() {
        this.style.display = 'none';
        const fallback = createEl('div', '', {
          style: 'width:48px;height:48px;border-radius:14px;background:linear-gradient(135deg, #f0f0f0, #e0e0e0);display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:900;color:#999;flex-shrink:0;'
        }, p.name.charAt(0).toUpperCase());
        row.insertBefore(fallback, row.firstChild);
      };
      
      if (p.photo) img.src = p.photo;
      
      const info = createEl('div', 'player-info-sm');
      const name = createEl('div', 'player-name-sm', {}, p.name);
      const role = createEl('div', 'player-role-sm', {}, p.role);
      
      info.appendChild(name);
      info.appendChild(role);
      row.appendChild(img);
      row.appendChild(info);
      tdPlayer.appendChild(row);
      
      const tdOvr = createEl('td', '', { style: 'text-align:right;' });
      const badge = createEl('span', 'ovr-badge', { style: 'margin:0;' }, p.ovr);
      if (CONFIG.SHOW_PRELIMINARY_BADGE) badge.title = '–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥';
      tdOvr.appendChild(badge);
      
      tr.appendChild(tdPos);
      tr.appendChild(tdPlayer);
      tr.appendChild(tdOvr);
      fragment.appendChild(tr);
    });
    
    tbody.appendChild(fragment);
  };

  // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –∏–≥—Ä–æ–∫–∞
  const openPlayerModal = (name) => {
    const player = state.players.find(p => p.name.toLowerCase() === name.toLowerCase());
    if (!player) {
      showToast('–ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω');
      return;
    }
    
    state.lastFocused = document.activeElement;
    state.currentModal = 'playerModal';
    
    const modal = document.getElementById('playerModal');
    const mName = document.getElementById('m-name');
    const mRole = document.getElementById('m-role');
    const mOvr = document.getElementById('m-ovr');
    const mImg = document.getElementById('m-img');
    const mBadges = document.getElementById('m-badges');
    const mStats = document.getElementById('m-stats');
    
    if (mName) mName.textContent = player.name;
    if (mRole) mRole.textContent = player.role;
    
    if (mOvr) {
      if (CONFIG.SHOW_PRELIMINARY_BADGE) {
        mOvr.innerHTML = `${player.ovr}<span class="ovr-sub">–ø—Ä–µ–¥–≤.</span>`;
      } else {
        mOvr.textContent = player.ovr;
      }
    }
    
    if (mImg) {
      mImg.classList.remove('loaded');
      if (player.photo) {
        mImg.src = player.photo;
        mImg.onload = () => mImg.classList.add('loaded');
        mImg.onerror = () => {
          mImg.style.display = 'none';
          const container = document.getElementById('m-img-container');
          if (container) {
            container.style.background = 'linear-gradient(135deg, #f0f0f0, #e8e8e8)';
            container.innerHTML = `<div style="display:flex;align-items:center;justify-content:center;height:100%;font-size:48px;font-weight:900;color:#ccc;">${player.name.charAt(0)}</div>`;
          }
        };
      } else {
        mImg.style.display = 'none';
      }
    }
    
    if (mBadges) {
      mBadges.innerHTML = '';
      player.badges.forEach(badge => {
        const span = createEl('span', 'badge', { role: 'listitem' }, badge);
        mBadges.appendChild(span);
      });
    }
    
    if (mStats) {
      const isGK = player.role === '–í—Ä–∞—Ç–∞—Ä—å';
      const stats = [
        { key: isGK ? 'REF' : 'DRI', value: player.drib || 0, label: isGK ? '–†–µ–∞–∫—Ü–∏—è' : '–î—Ä–∏–±–ª–∏–Ω–≥' },
        { key: isGK ? 'DIV' : 'SPD', value: player.speed || 0, label: isGK ? '–ü—Ä—ã–∂–æ–∫' : '–°–∫–æ—Ä–æ—Å—Ç—å' },
        { key: isGK ? 'HAN' : 'SHT', value: player.shot || 0, label: isGK ? '–†—É–∫–∏' : '–£–¥–∞—Ä' },
        { key: isGK ? 'POS' : 'PHY', value: player.phys || 0, label: isGK ? '–ü–æ–∑–∏—Ü–∏—è' : '–§–∏–∑–∏–∫–∞' }
      ];
      
      mStats.innerHTML = '';
      stats.forEach((s, idx) => {
        const item = createEl('div', 'stat-item');
        item.innerHTML = `
          <div class="stat-header">
            <div class="stat-label-group" data-tooltip="${escapeHTML(s.label)}" tabindex="0">
              <span class="stat-label">${s.key}</span>
              <i class="info-icon">?</i>
            </div>
            <span class="stat-value">${s.value}</span>
          </div>
          <div class="stat-bar-bg" aria-hidden="true">
            <div class="stat-bar-fill" id="bar-${idx}" style="width: 0%"></div>
          </div>
        `;
        mStats.appendChild(item);
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
        setTimeout(() => {
          const bar = item.querySelector(`#bar-${idx}`);
          if (bar) bar.style.width = `${Math.min(s.value, 100)}%`;
        }, 100 + (idx * 100));
      });
    }
    
    openModal('playerModal');
  };

  // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–ª–∫–∞–º–∏
  const openModal = (id) => {
    const modal = document.getElementById(id);
    if (!modal) return;
    
    state.currentModal = id;
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
    
    // Focus trap
    const cleanup = initFocusTrap(modal);
    modal._cleanupFocusTrap = cleanup;
    
    // Focus –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
    setTimeout(() => {
      const focusable = modal.querySelector('button, [href], input, select, textarea');
      if (focusable) focusable.focus();
    }, 100);
    
    // Escape handler
    const escapeHandler = (e) => {
      if (e.key === 'Escape') closeModal(id);
    };
    modal._escapeHandler = escapeHandler;
    document.addEventListener('keydown', escapeHandler);
  };

  const closeModal = (id) => {
    const modal = document.getElementById(id);
    if (!modal) return;
    
    modal.classList.remove('active');
    document.body.style.overflow = '';
    
    if (modal._escapeHandler) {
      document.removeEventListener('keydown', modal._escapeHandler);
      delete modal._escapeHandler;
    }
    if (modal._cleanupFocusTrap) {
      modal._cleanupFocusTrap();
      delete modal._cleanupFocusTrap;
    }
    
    if (state.lastFocused) {
      state.lastFocused.focus();
      state.lastFocused = null;
    }
    
    // –°–±—Ä–æ—Å URL
    const currentTab = document.querySelector('section.active')?.id || 'home';
    if (window.history.replaceState) {
      window.history.replaceState(null, null, `#${currentTab}`);
    }
  };

  // –ö–Ω–æ–ø–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏
  const setupDownloadButton = () => {
    const btn = document.getElementById('download-card');
    if (!btn) return;
    
    btn.addEventListener('click', async (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      btn.style.opacity = '0.5';
      btn.disabled = true;
      showToast('–°–æ–∑–¥–∞—ë–º –∫–∞—Ä—Ç–æ—á–∫—É...', 2000);
      
      try {
        const card = document.getElementById('stats-card');
        if (!card) throw new Error('Card not found');
        
        // –ñ–¥—ë–º –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        const img = document.getElementById('m-img');
        if (img && !img.complete) {
          await new Promise((resolve) => {
            img.onload = resolve;
            img.onerror = resolve;
            setTimeout(resolve, 1000);
          });
        }
        
        const canvas = await html2canvas(card, {
          scale: 2,
          useCORS: true,
          allowTaint: true,
          backgroundColor: '#ffffff',
          logging: false,
          ignoreElements: (element) => element.classList.contains('modal-header-fixed')
        });
        
        const playerName = document.getElementById('m-name')?.textContent || 'player';
        const safeName = playerName.replace(/[^a-zA-Z–∞-—è–ê-–Ø0-9]/g, '_');
        const fileName = `BOX1V1_${safeName}.png`;
        
        // –ü—Ä–æ–±—É–µ–º Web Share API
        const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
        if (blob && navigator.share && navigator.canShare) {
          const file = new File([blob], fileName, { type: 'image/png' });
          if (navigator.canShare({ files: [file] })) {
            try {
              await navigator.share({ files: [file], title: `BOX1V1 ${playerName}` });
              showToast('–ì–æ—Ç–æ–≤–æ!');
              return;
            } catch (err) {
              if (err.name === 'AbortError') return;
            }
          }
        }
        
        // Fallback: —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
        const link = document.createElement('a');
        link.download = fileName;
        link.href = canvas.toDataURL();
        link.click();
        showToast('–ö–∞—Ä—Ç–æ—á–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
        
      } catch (error) {
        console.error('Download error:', error);
        showToast('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏');
      } finally {
        btn.style.opacity = '';
        btn.disabled = false;
      }
    });
  };

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
  const setupEventListeners = () => {
    // –ü–æ–∏—Å–∫ —Å debounce
    const searchInput = document.getElementById('playerSearch');
    if (searchInput) {
      let timeout;
      searchInput.addEventListener('input', (e) => {
        state.searchQuery = e.target.value.toLowerCase().trim();
        clearTimeout(timeout);
        timeout = setTimeout(renderRoster, 150);
      });
    }
    
    // –§–∏–ª—å—Ç—Ä—ã
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        document.querySelectorAll('.filter-btn').forEach(b => {
          b.classList.remove('active');
          b.setAttribute('aria-pressed', 'false');
        });
        e.target.classList.add('active');
        e.target.setAttribute('aria-pressed', 'true');
        state.filter = e.target.getAttribute('data-role') || '–í—Å–µ';
        renderRoster();
      });
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ
    document.querySelectorAll('.modal-overlay').forEach(modal => {
      modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal(modal.id);
      });
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–Ω–æ–ø–∫–µ
    document.querySelectorAll('.modal-close').forEach(btn => {
      const modal = btn.closest('.modal-overlay');
      if (modal) {
        btn.addEventListener('click', () => closeModal(modal.id));
      }
    });
    
    // –°–∫—Ä–æ–ª–ª –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    let ticking = false;
    window.addEventListener('scroll', () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          document.getElementById('navbar')?.classList.toggle('scrolled', window.scrollY > 50);
          ticking = false;
        });
        ticking = true;
      }
    }, { passive: true });
  };

  // –û–±—â–∏–π —Ä–µ–Ω–¥–µ—Ä
  const render = () => {
    renderRoster();
    renderStats();
  };

  // –ü—É–±–ª–∏—á–Ω—ã–π API
  return {
    init,
    switchTab: (id) => {
      document.querySelectorAll('section').forEach(s => {
        s.classList.remove('active');
        s.setAttribute('aria-hidden', 'true');
      });
      document.querySelectorAll('.nav-links a').forEach(a => {
        a.classList.remove('active');
        a.setAttribute('aria-current', 'false');
      });
      
      const target = document.getElementById(id);
      if (target) {
        target.classList.add('active');
        target.removeAttribute('aria-hidden');
      }
      
      const btn = document.getElementById(`btn-${id}`);
      if (btn) {
        btn.classList.add('active');
        btn.setAttribute('aria-current', 'page');
      }
      
      window.scrollTo({ top: 0, behavior: 'smooth' });
    },
    
    toggleMenu: () => {
      const drawer = document.getElementById('mobile-drawer');
      const overlay = document.getElementById('drawer-overlay');
      const burger = document.getElementById('burger');
      
      const isOpen = drawer?.classList.toggle('open');
      overlay?.classList.toggle('open');
      burger?.classList.toggle('open');
      burger?.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
      
      if (isOpen) {
        document.body.style.overflow = 'hidden';
        setTimeout(() => drawer?.querySelector('a')?.focus(), 100);
      } else {
        document.body.style.overflow = '';
      }
    },
    
    handleMobileNav: (id, isModal = false) => {
      App.toggleMenu();
      setTimeout(() => {
        if (isModal) openModal(id);
        else App.switchTab(id);
      }, 300);
    },
    
    openModal,
    closeModal,
    openPlayerModal,
    
    copyPlayerID: async () => {
      const name = document.getElementById('m-name')?.textContent;
      if (!name) return;
      try {
        await navigator.clipboard.writeText(name);
        showToast('ID —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω');
      } catch {
        showToast('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å');
      }
    },
    
    sharePlayer: async () => {
      const name = document.getElementById('m-name')?.textContent;
      const url = window.location.href;
      if (navigator.share) {
        try {
          await navigator.share({ title: `BOX1V1 | ${name}`, text: `–ö–∞—Ä—Ç–æ—á–∫–∞ –∞—Ç–ª–µ—Ç–∞ ${name}`, url });
        } catch (err) {
          if (err.name !== 'AbortError') showToast('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ');
        }
      } else {
        try {
          await navigator.clipboard.writeText(url);
          showToast('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞');
        } catch {
          showToast('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É');
        }
      }
    }
  };
})();

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
document.addEventListener('DOMContentLoaded', App.init);
</script>
</body>
</html>

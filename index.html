<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>BOX1V1 | –¶–ò–§–†–û–í–ê–Ø –≠–ö–û–°–ò–°–¢–ï–ú–ê</title>
<meta name="description" content="BOX1V1 ‚Äî –∑–∞–∫—Ä—ã—Ç–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ñ—É—Ç–±–æ–ª–∏—Å—Ç–æ–≤ 1 –Ω–∞ 1. –¢–µ—Ö–Ω–∏–∫–∞, –º–µ–¥–∏–∞ –∏ —Å–∫–∞—É—Ç–∏–Ω–≥.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://box1v1.ru/">
<meta property="og:title" content="BOX1V1 | –¶–ò–§–†–û–í–ê–Ø –≠–ö–û–°–ò–°–¢–ï–ú–ê">
<meta property="og:description" content="–°—Ç–∞–Ω—å —á–∞—Å—Ç—å—é —ç–ª–∏—Ç–∞—Ä–Ω–æ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ —Ñ—É—Ç–±–æ–ª–∏—Å—Ç–æ–≤ 1x1. –†–µ–π—Ç–∏–Ω–≥–∏, –∫–∞—Ä—Ç–æ—á–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.">
<meta property="og:image" content="https://box1v1.ru/preview-og.jpg">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
<style>
:root {
--bg: #ffffff;
--bg-alt: #f8f8f8;
--card: #ffffff;
--text: #0a0a0a;
--text-dim: #6b7280;
--border: rgba(0,0,0,0.06);
--accent: #22c55e;
--accent-dark: #16a34a;
--accent-rgb: 34, 197, 94;
--ls-tight: -0.04em;
--ls-normal: -0.01em;
--lh-tight: 1.1;
--lh-base: 1.6;
--shadow-sm: 0 2px 8px rgba(0,0,0,0.04);
--shadow-md: 0 20px 40px -12px rgba(0,0,0,0.08);
--shadow-lg: 0 30px 60px rgba(0,0,0,0.12);
--cubic: cubic-bezier(0.2, 0, 0, 1);
--glass: rgba(255,255,255,0.8);
--radius: 20px;
--radius-sm: 12px;
--radius-lg: 32px;
--container-padding: 24px;
--nav-height: 72px;
--nav-height-scrolled: 64px;
}
* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html {
scroll-behavior: smooth;
background: var(--bg);
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
}
body {
font-family: 'Inter', system-ui, -apple-system, sans-serif;
background: var(--bg);
color: var(--text);
overflow-x: hidden;
line-height: var(--lh-base);
letter-spacing: var(--ls-normal);
font-size: 16px;
}
h1, h2, h3, h4 {
font-weight: 900;
font-style: italic;
letter-spacing: var(--ls-tight);
line-height: var(--lh-tight);
text-transform: uppercase;
}
p { 
font-size: 1rem; 
color: var(--text-dim);
line-height: 1.5;
}

/* UX TOOLTIPS STYLES */
.stat-item { position: relative; }
.stat-header { 
display: flex; 
align-items: center; 
gap: 6px; 
cursor: help;
position: relative;
}
.info-icon {
width: 14px; 
height: 14px; 
border-radius: 50%; 
border: 1px solid var(--border);
display: flex; 
align-items: center; 
justify-content: center;
font-size: 8px; 
color: var(--text-dim); 
transition: 0.3s var(--cubic);
font-style: normal; 
font-weight: 800;
}
.stat-header:hover .info-icon { 
background: var(--text); 
color: #fff; 
border-color: var(--text); 
}

.stat-header::after {
content: attr(data-tip);
position: absolute; 
bottom: calc(100% + 10px); 
left: 0;
background: #000; 
color: #fff; 
padding: 10px 14px; 
border-radius: 12px;
font-size: 11px; 
font-weight: 500; 
width: 200px; 
line-height: 1.4;
opacity: 0; 
visibility: hidden; 
transform: translateY(10px);
transition: 0.4s var(--cubic); 
z-index: 100; 
pointer-events: none;
box-shadow: var(--shadow-md); 
text-transform: none; 
font-style: normal;
text-align: left;
}
.stat-header:hover::after { 
opacity: 1; 
visibility: visible; 
transform: translateY(0); 
}

/* PRELOADER */
#preloader {
position: fixed; 
inset: 0; 
background: #fff; 
z-index: 9999;
display: flex; 
justify-content: center; 
align-items: center;
transition: opacity 0.8s var(--cubic), visibility 0.8s;
}
#preloader.loaded { 
opacity: 0; 
visibility: hidden; 
pointer-events: none;
}

/* TOASTS SYSTEM */
#toast-container {
position: fixed; 
bottom: 24px; 
left: 50%; 
transform: translateX(-50%);
z-index: 10000; 
display: flex; 
flex-direction: column; 
gap: 10px;
pointer-events: none;
width: 90%;
max-width: 400px;
}
.toast {
background: #000; 
color: #fff; 
padding: 16px 20px; 
border-radius: 14px;
font-size: 13px; 
font-weight: 700; 
box-shadow: var(--shadow-lg);
animation: toastIn 0.5s var(--cubic) forwards; 
pointer-events: auto;
display: flex; 
align-items: center; 
gap: 12px;
justify-content: space-between;
}
.toast-close {
background: transparent;
border: none;
color: rgba(255,255,255,0.7);
font-size: 20px;
cursor: pointer;
padding: 0;
width: 24px;
height: 24px;
display: flex;
align-items: center;
justify-content: center;
transition: 0.2s;
}
.toast-close:hover {
color: white;
}
@keyframes toastIn {
from { transform: translateY(100px); opacity: 0; }
to { transform: translateY(0); opacity: 1; }
}
.toast-out {
animation: toastOut 0.3s var(--cubic) forwards;
}
@keyframes toastOut {
from { transform: translateY(0); opacity: 1; }
to { transform: translateY(100px); opacity: 0; }
}

/* NAVIGATION */
nav {
position: fixed; 
top: 0; 
left: 0; 
width: 100%; 
height: var(--nav-height);
background: var(--glass); 
backdrop-filter: blur(24px) saturate(180%);
-webkit-backdrop-filter: blur(24px) saturate(180%); 
z-index: 1000;
transition: 0.4s var(--cubic); 
border-bottom: 1px solid transparent;
}
body.scrolled nav {
border-bottom: 1px solid var(--border);
background: rgba(255,255,255,0.95); 
height: var(--nav-height-scrolled);
}
.nav-inner {
max-width: 1300px; 
margin: 0 auto; 
height: 100%;
display: flex; 
align-items: center; 
justify-content: space-between; 
padding: 0 var(--container-padding);
}
.logo {
font-size: 1.5rem; 
font-weight: 900; 
font-style: italic; 
letter-spacing: -0.5px; 
cursor: pointer;
transition: 0.3s;
display: flex;
align-items: center;
gap: 4px;
}
.logo:hover { 
opacity: 0.7; 
}
.nav-links { 
display: flex; 
gap: 4px; 
}
.nav-links a {
text-decoration: none; 
font-size: 12px; 
font-weight: 800;
letter-spacing: 0.05em; 
text-transform: uppercase; 
color: var(--text-dim);
padding: 10px 16px; 
border-radius: var(--radius-sm); 
transition: 0.3s var(--cubic);
position: relative;
}
.nav-links a:hover { 
color: var(--text); 
background: var(--bg-alt); 
}
.nav-links a:focus-visible { 
outline: 2px solid var(--accent); 
outline-offset: 4px; 
}
.nav-links a.active { 
color: #fff; 
background: var(--text); 
}

/* BURGER MENU */
.burger {
display: none; 
cursor: pointer; 
width: 48px; 
height: 48px; 
flex-direction: column;
justify-content: center; 
align-items: center; 
gap: 6px; 
border-radius: var(--radius-sm);
background: var(--bg-alt); 
border: none; 
transition: 0.3s;
position: relative;
z-index: 2001;
}
.burger:hover { 
background: #eee; 
}
.burger span { 
width: 20px; 
height: 2px; 
background: var(--text); 
border-radius: 4px; 
transition: 0.3s var(--cubic); 
}
.burger.open span:nth-child(1) { 
transform: translateY(8px) rotate(45deg); 
}
.burger.open span:nth-child(2) { 
opacity: 0; 
}
.burger.open span:nth-child(3) { 
transform: translateY(-8px) rotate(-45deg); 
}

/* DRAWER */
.drawer-overlay { 
position: fixed; 
inset: 0; 
background: rgba(0,0,0,0.2); 
backdrop-filter: blur(8px); 
z-index: 1999; 
opacity: 0; 
visibility: hidden; 
transition: 0.4s var(--cubic);
}
.drawer-overlay.open { 
opacity: 1; 
visibility: visible; 
}
.mobile-drawer { 
position: fixed; 
top: 0; 
right: -100%; 
width: 85%; 
max-width: 320px; 
height: 100%; 
background: #fff; 
z-index: 2000; 
padding: 100px 32px 40px; 
display: flex; 
flex-direction: column; 
gap: 16px; 
transition: 0.5s var(--cubic);
overflow-y: auto;
}
.mobile-drawer.open { 
right: 0; 
box-shadow: -40px 0 80px rgba(0,0,0,0.1); 
}
.mobile-drawer a { 
font-size: 2rem; 
font-weight: 900; 
text-decoration: none; 
color: var(--text); 
font-style: italic; 
text-transform: uppercase; 
letter-spacing: -1px; 
padding: 12px 0;
transition: 0.3s;
}
.mobile-drawer a:hover {
color: var(--accent);
transform: translateX(8px);
}
.mobile-drawer .btn {
margin-top: 24px;
}

/* MAIN CONTENT */
.main-content { 
max-width: 1300px; 
margin: 0 auto; 
padding: 120px var(--container-padding) 100px; 
min-height: 80vh; 
}
section { 
display: none; 
opacity: 0; 
animation: fadeInUp 0.8s var(--cubic) forwards;
}
section.active { 
display: block; 
opacity: 1;
}
@keyframes fadeInUp {
from { opacity: 0; transform: translateY(30px); }
to { opacity: 1; transform: translateY(0); }
}

/* INTRO SECTION */
.intro-block { 
padding: 40px 0 80px; 
text-align: center; 
max-width: 800px; 
margin: 0 auto; 
}
.intro-block h1 { 
font-size: clamp(3.2rem, 10vw, 7rem); 
margin-bottom: 20px; 
letter-spacing: -3px;
}
.intro-block p { 
font-size: 1.125rem; 
max-width: 500px; 
margin: 0 auto 40px; 
color: var(--text-dim);
}

/* BUTTONS */
.btn {
padding: 16px 28px; 
border-radius: var(--radius-sm); 
font-weight: 800;
text-transform: uppercase; 
font-size: 13px; 
letter-spacing: 0.05em;
cursor: pointer; 
transition: all 0.3s var(--cubic); 
border: none;
text-decoration: none; 
display: inline-flex; 
align-items: center; 
justify-content: center; 
gap: 10px;
position: relative; 
overflow: hidden;
white-space: nowrap;
}
.btn:active { 
transform: scale(0.96); 
}
.btn-primary { 
background: var(--text); 
color: #fff; 
border: 1.5px solid var(--text);
}
.btn-primary:hover { 
transform: translateY(-3px); 
box-shadow: var(--shadow-md); 
background: #000;
}
.btn-outline { 
background: transparent; 
border: 1.5px solid var(--border); 
color: var(--text);
}
.btn-outline:hover { 
background: var(--bg-alt); 
border-color: var(--text); 
}
.btn-accent {
background: var(--accent);
color: #000;
font-weight: 900;
border: 1.5px solid var(--accent);
}
.btn-accent:hover {
background: var(--accent-dark);
transform: translateY(-3px);
box-shadow: 0 10px 30px rgba(var(--accent-rgb), 0.3);
}

/* BENTO GRID */
.bento-grid { 
display: grid; 
grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
gap: 20px; 
margin-top: 40px; 
}
.card {
background: var(--card); 
border-radius: var(--radius); 
border: 1px solid var(--border);
padding: 32px; 
position: relative; 
overflow: hidden; 
transition: 0.5s var(--cubic);
cursor: pointer; 
display: flex; 
flex-direction: column;
min-height: 240px;
}
.card:hover { 
transform: translateY(-8px); 
border-color: rgba(0,0,0,0.1); 
box-shadow: var(--shadow-md); 
}
.card:focus-visible { 
outline: 3px solid var(--accent); 
outline-offset: 2px;
}
.card h2 {
font-size: 2.5rem;
margin: 16px 0 12px;
}
.card h3 {
font-size: 1.5rem;
margin-bottom: 8px;
}

/* PLAYER CARD */
.player-card { 
height: 380px; 
background: #000; 
color: #fff; 
border: none; 
padding: 24px; 
}
.player-img {
position: absolute; 
inset: 0; 
background-size: cover; 
background-position: center top;
filter: grayscale(1); 
opacity: 0.5; 
transition: 1s var(--cubic);
}
.player-card:hover .player-img { 
filter: grayscale(0); 
opacity: 0.7; 
transform: scale(1.05); 
}
.player-card::after {
content: ''; 
position: absolute; 
inset: 0;
background: linear-gradient(to top, #000 5%, rgba(0,0,0,0.4) 40%, transparent 90%); 
z-index: 1;
}
.player-info { 
position: relative; 
z-index: 2; 
margin-top: auto; 
}
.ovr-badge {
display: inline-block; 
padding: 6px 14px; 
background: var(--accent);
color: #000; 
border-radius: 10px; 
font-weight: 900; 
font-size: 12px; 
margin-top: 12px;
}

/* STATS TABLE */
.table-wrapper { 
background: #fff; 
border-radius: var(--radius); 
border: 1px solid var(--border); 
overflow: hidden; 
}
table { 
width: 100%; 
border-collapse: collapse; 
}
th { 
text-align: left; 
padding: 20px 24px; 
font-size: 11px; 
font-weight: 800; 
text-transform: uppercase; 
color: var(--text-dim); 
border-bottom: 1px solid var(--border); 
background: var(--bg-alt);
}
td { 
padding: 20px 24px; 
border-bottom: 1px solid var(--border); 
transition: 0.3s; 
}
tr:last-child td { 
border-bottom: none; 
}
tr:hover td {
background: rgba(0,0,0,0.02);
}

/* MODAL */
.modal-overlay {
position: fixed; 
inset: 0; 
background: rgba(255,255,255,0.7);
backdrop-filter: blur(20px); 
-webkit-backdrop-filter: blur(20px);
z-index: 3000; 
display: flex; 
justify-content: center; 
align-items: center;
padding: 20px; 
opacity: 0; 
pointer-events: none; 
transition: 0.4s var(--cubic);
}
.modal-overlay.active { 
opacity: 1; 
pointer-events: auto; 
}
.modal-content {
background: #fff; 
width: 100%; 
max-width: 540px; 
border-radius: var(--radius-lg);
padding: 40px; 
position: relative; 
max-height: 90vh; 
overflow-y: auto;
box-shadow: var(--shadow-lg); 
transform: translateY(40px) scale(0.95); 
transition: 0.6s var(--cubic);
}
.modal-overlay.active .modal-content { 
transform: translateY(0) scale(1); 
}
.modal-close {
position: absolute; 
top: 20px; 
right: 20px; 
width: 44px; 
height: 44px;
background: var(--bg-alt); 
border-radius: 50%; 
display: flex;
align-items: center; 
justify-content: center; 
cursor: pointer; 
z-index: 10;
border: none; 
transition: 0.3s var(--cubic);
font-size: 18px;
}
.modal-close:hover { 
transform: rotate(90deg); 
background: #eee; 
}

/* SEARCH & FILTER */
.search-input {
padding: 16px 24px; 
border-radius: var(--radius-sm); 
border: 1.5px solid var(--border);
background: var(--bg-alt); 
width: 100%; 
max-width: 360px; 
font-family: inherit;
font-weight: 600; 
font-size: 14px;
transition: 0.3s;
}
.search-input:focus { 
outline: none; 
border-color: var(--text); 
background: #fff; 
box-shadow: 0 0 0 4px rgba(0,0,0,0.03); 
}
.filter-bar {
display: flex; 
gap: 8px; 
padding-bottom: 8px;
overflow-x: auto;
scrollbar-width: none;
}
.filter-bar::-webkit-scrollbar {
display: none;
}
.filter-btn {
padding: 12px 20px; 
border-radius: var(--radius-sm); 
border: 1px solid var(--border);
background: #fff; 
font-size: 12px; 
font-weight: 800; 
cursor: pointer;
text-transform: uppercase; 
white-space: nowrap; 
transition: 0.3s;
flex-shrink: 0;
}
.filter-btn:hover { 
background: var(--bg-alt); 
}
.filter-btn.active { 
background: var(--text); 
color: #fff; 
border-color: var(--text); 
}

/* TIMER */
.timer-context { 
margin-top: 60px; 
padding: 24px 32px; 
background: var(--bg-alt); 
border-radius: var(--radius-lg); 
display: inline-flex; 
align-items: center; 
gap: 32px; 
border: 1px solid var(--border); 
}
.countdown { 
display: flex; 
gap: 20px; 
}
.countdown > div {
text-align: center;
}
.countdown-value { 
font-size: 2rem; 
font-weight: 900; 
letter-spacing: -2px; 
}
.countdown-label {
font-size: 11px;
font-weight: 800;
text-transform: uppercase;
color: var(--text-dim);
margin-top: 4px;
}

/* SCROLLBAR */
::-webkit-scrollbar { 
width: 8px; 
}
::-webkit-scrollbar-track { 
background: transparent; 
}
::-webkit-scrollbar-thumb { 
background: var(--border); 
border-radius: 10px; 
}
::-webkit-scrollbar-thumb:hover { 
background: #ccc; 
}

/* MOBILE ADAPTIVITY */
@media (max-width: 1024px) {
:root {
--radius: 18px;
--radius-sm: 10px;
--container-padding: 20px;
}
.bento-grid {
grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
gap: 16px;
}
.player-card {
height: 340px;
}
}

@media (max-width: 768px) {
:root {
--container-padding: 16px;
--nav-height: 64px;
--nav-height-scrolled: 56px;
}
.nav-links { 
display: none; 
}
.burger { 
display: flex; 
}
.nav-inner { 
padding: 0 var(--container-padding); 
}
.main-content { 
padding: 100px var(--container-padding) 60px; 
}
.intro-block { 
padding: 20px 0 60px; 
}
.intro-block h1 { 
font-size: 2.8rem; 
letter-spacing: -2px;
}
.intro-block p { 
font-size: 1rem; 
margin-bottom: 32px;
}
.timer-context { 
border-radius: var(--radius); 
flex-direction: column; 
gap: 16px; 
width: 100%; 
padding: 24px 20px; 
margin-top: 40px; 
text-align: center;
}
.countdown { 
gap: 16px; 
}
.countdown-value { 
font-size: 1.8rem; 
}
.bento-grid { 
grid-template-columns: 1fr; 
gap: 16px; 
}
.card { 
padding: 24px 20px; 
min-height: 200px;
}
.card[style*="grid-column: span 2"] { 
grid-column: span 1 !important; 
}
.card h2 { 
font-size: 2rem !important; 
}
.modal-content { 
padding: 32px 20px; 
border-radius: var(--radius-lg); 
}
.controls-row { 
flex-direction: column; 
align-items: stretch !important; 
gap: 16px;
}
.search-input { 
max-width: 100%; 
}
.filter-bar { 
width: 100%; 
}
.player-card { 
height: 320px; 
padding: 20px;
}
.mobile-drawer {
padding: 100px 24px 32px;
}
.mobile-drawer a {
font-size: 1.8rem;
}
}

@media (max-width: 480px) {
:root {
--container-padding: 12px;
}
.intro-block h1 { 
font-size: 2.2rem; 
}
.card {
padding: 20px 16px;
}
.player-card {
height: 300px;
}
.modal-content {
padding: 24px 16px;
border-radius: 24px;
}
.countdown {
gap: 12px;
}
.countdown-value {
font-size: 1.5rem;
}
.btn {
padding: 14px 20px;
font-size: 12px;
}
}

@media (max-width: 360px) {
.player-card {
height: 280px;
}
.card h2 {
font-size: 1.8rem !important;
}
.countdown {
gap: 8px;
}
.countdown-value {
font-size: 1.3rem;
}
}

/* SMALL HEIGHT DEVICES */
@media (max-height: 700px) {
.intro-block {
padding: 20px 0 40px;
}
.player-card {
height: 280px;
}
}

@keyframes load { 
0% { transform: translateX(-100%); } 
100% { transform: translateX(100%); } 
}
</style>
</head>
<body>
<div id="toast-container"></div>
<div id="preloader" role="status" aria-label="–ó–∞–≥—Ä—É–∑–∫–∞">
<div style="text-align:center;">
<h2 style="font-size:3rem; margin-bottom:10px;">BOX<span style="color:var(--accent)">1</span>V1</h2>
<div style="width:140px; height:2px; background:var(--bg-alt); margin:0 auto; position:relative; overflow:hidden;">
<div style="position:absolute; width:60%; height:100%; background:var(--text); animation: load 1.5s infinite var(--cubic);"></div>
</div>
</div>
</div>

<nav id="navbar">
<div class="nav-inner">
<div class="logo" onclick="switchTab('home')" aria-label="–ù–∞ –≥–ª–∞–≤–Ω—É—é">BOX<span style="color:var(--accent)">1</span>V1</div>
<div class="nav-links" role="navigation">
<a href="#home" onclick="switchTab('home')" class="active" id="btn-home">–ì–ª–∞–≤–Ω–∞—è</a>
<a href="#roster" onclick="switchTab('roster')" id="btn-roster">–£–ß–ê–°–¢–ù–ò–ö–ò</a>
<a href="#stats" onclick="switchTab('stats')" id="btn-stats">–†–µ–π—Ç–∏–Ω–≥</a>
</div>
<button class="burger" id="burger" onclick="toggleMenu()" aria-label="–ú–µ–Ω—é" aria-expanded="false">
<span></span><span></span><span></span>
</button>
</div>
</nav>

<div class="drawer-overlay" id="drawer-overlay" onclick="toggleMenu()"></div>
<div class="mobile-drawer" id="mobile-drawer">
<a href="#home" onclick="handleMobileNav('home')">–ì–ª–∞–≤–Ω–∞—è</a>
<a href="#roster" onclick="handleMobileNav('roster')">–£—á–∞—Å—Ç–Ω–∏–∫–∏</a>
<a href="#stats" onclick="handleMobileNav('stats')">–†–µ–π—Ç–∏–Ω–≥</a>
<div style="margin-top:auto;">
<button class="btn btn-primary" style="width:100%" onclick="handleMobileNav('applyModal', true)">–°—Ç–∞—Ç—å —á–∞—Å—Ç—å—é</button>
</div>
</div>

<main class="main-content">
<section id="home" class="active">
<div class="intro-block">
<span style="font-size:12px; font-weight:800; text-transform:uppercase; letter-spacing:0.3em; color:var(--accent-dark); display:block; margin-bottom:16px;">The Next Gen Football</span>
<h1>BOX1V1.</h1>
<p>–†–µ—à–∞–µ—Ç –Ω–µ –∫–æ–º–∞–Ω–¥–∞.<br>–†–µ—à–∞–µ—à—å —Ç—ã.</p>
<div class="btn-group" style="display:flex; gap:12px; justify-content:center; flex-wrap:wrap;">
<button class="btn btn-primary" onclick="switchTab('roster')">–£—á–∞—Å—Ç–Ω–∏–∫–∏</button>
<button class="btn btn-outline" onclick="openModal('applyModal')">–ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É</button>
</div>
<div class="timer-context" id="timer-container">
<span class="timer-label" id="timer-status" style="font-weight:800; font-size:13px;">–î–æ —Å—Ç–∞—Ä—Ç–∞ —Å–µ–∑–æ–Ω–∞:</span>
<div class="countdown" id="timer">
<div><div class="countdown-value" id="days">00</div><div class="countdown-label">–¥–Ω</div></div>
<div><div class="countdown-value" id="hours">00</div><div class="countdown-label">—á—Å</div></div>
<div><div class="countdown-value" id="mins">00</div><div class="countdown-label">–º–∏–Ω</div></div>
<div><div class="countdown-value" id="secs">00</div><div class="countdown-label">—Å–µ–∫</div></div>
</div>
</div>
</div>
<div class="bento-grid">
<div class="card" style="grid-column: span 2; background: linear-gradient(135deg, #fafafa 0%, #f0f0f0 100%);" onclick="openModal('rulesModal')" tabindex="0">
<span style="font-size:11px; font-weight:800; color:var(--accent-dark); text-transform:uppercase; letter-spacing:0.1em;">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</span>
<h2 style="font-size: 3rem; margin: 16px 0 12px;">–†–ï–ì–õ–ê–ú–ï–ù–¢.</h2>
<p>–°–≤–æ–¥ –ø—Ä–∞–≤–∏–ª –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –º–∞—Ç—á–µ–π.</p>
<div style="margin-top: auto; padding-top: 24px; font-weight: 800; font-size: 12px; text-transform: uppercase; color: var(--accent);">–ò–∑—É—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ ‚Üí</div>
</div>
<div class="card" onclick="window.open('https://t.me/streetbox1v1')" tabindex="0">
<h3 style="font-size: 1.5rem;">TELEGRAM</h3>
<p style="font-size: 14px; margin-top: 8px;">–°–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.</p>
</div>
<div class="card" onclick="window.open('https://instagram.com/box.1v1')" tabindex="0">
<h3 style="font-size: 1.5rem;">INSTAGRAM</h3>
<p style="font-size: 14px; margin-top: 8px;">–ì–ª–∞–≤–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –≤ –º–µ–¥–∏–∞ —Ñ–æ—Ä–º–∞—Ç–µ.</p>
</div>
</div>
</section>

<section id="roster">
<div style="margin-bottom: 40px;">
<h1 style="font-size: clamp(2.5rem, 8vw, 5rem);">–£–ß–ê–°–¢–ù–ò–ö–ò.</h1>
<p style="font-size: 1.125rem;">–î–µ–π—Å—Ç–≤—É—é—â–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ BOX1V1.</p>
</div>
<div class="controls-row" style="margin-bottom: 32px; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:16px;">
<input type="text" class="search-input" id="playerSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏..." oninput="debouncedRender()" aria-label="–ü–æ–∏—Å–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤">
<div class="filter-bar">
<button class="filter-btn active" data-role="–í—Å–µ" onclick="setRoleFilter('–í—Å–µ', this)">–í—Å–µ</button>
<button class="filter-btn" data-role="–ò–≥—Ä–æ–∫" onclick="setRoleFilter('–ò–≥—Ä–æ–∫', this)">–ü–æ–ª–µ–≤—ã–µ</button>
<button class="filter-btn" data-role="–í—Ä–∞—Ç–∞—Ä—å" onclick="setRoleFilter('–í—Ä–∞—Ç–∞—Ä—å', this)">–í—Ä–∞—Ç–∞—Ä–∏</button>
</div>
</div>
<div class="bento-grid" id="roster-grid"></div>
</section>

<section id="stats">
<h1 style="font-size: clamp(2.5rem, 8vw, 5rem); margin-bottom:32px;">–†–ï–ô–¢–ò–ù–ì.</h1>
<div class="table-wrapper">
<table role="grid">
<thead>
<tr><th>#.</th><th>–ò–≥—Ä–æ–∫</th><th style="text-align:right;">OVR —Ä–µ–π—Ç–∏–Ω–≥</th></tr>
</thead>
<tbody id="stats-body"></tbody>
</table>
</div>
</section>
</main>

<!-- PLAYER MODAL -->
<div class="modal-overlay" id="playerModal" onclick="closeModal('playerModal')" role="dialog" aria-modal="true">
<div class="modal-content" onclick="event.stopPropagation()">
<button class="modal-close" onclick="closeModal('playerModal')" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
<div id="m-img-container" style="width:100%; height:280px; border-radius:20px; overflow:hidden; background:#f0f0f0; margin-bottom:24px;">
<img id="m-img" src="" style="width:100%; height:100%; object-fit:cover;" alt="–§–æ—Ç–æ –∏–≥—Ä–æ–∫–∞" loading="lazy">
</div>
<div style="display:flex; justify-content:space-between; align-items:flex-start;">
<div>
<span id="m-role" style="font-size:11px; font-weight:800; text-transform:uppercase; color:var(--accent-dark); background:rgba(34,197,94,0.1); padding:6px 12px; border-radius:10px;">ROLE</span>
<h2 id="m-name" style="font-size: 2rem; margin-top:12px;">NAME</h2>
<div id="m-badges" style="display:flex; gap:6px; margin-top:12px; flex-wrap:wrap;"></div>
</div>
<div id="m-ovr" style="font-size: 2.5rem; font-weight:900; font-style:italic; line-height:1; letter-spacing:-2px;">99</div>
</div>
<div id="m-stats" style="margin-top:32px; display:grid; grid-template-columns: 1fr 1fr; gap: 24px;"></div>
<div style="margin-top:32px; display:flex; gap:12px; flex-wrap:wrap;">
<button class="btn btn-accent" style="flex:2; min-width:200px;" onclick="downloadPlayerCard()">
üì• –°–ö–ê–ß–ê–¢–¨ –ö–ê–†–¢–û–ß–ö–£
</button>
<button class="btn btn-outline" style="flex:1; min-width:140px;" onclick="sharePlayer()">
–ü–û–î–ï–õ–ò–¢–¨–°–Ø
</button>
</div>
</div>
</div>

<!-- APPLY MODAL -->
<div class="modal-overlay" id="applyModal" onclick="closeModal('applyModal')" role="dialog" aria-modal="true">
<div class="modal-content" onclick="event.stopPropagation()">
<button class="modal-close" onclick="closeModal('applyModal')">‚úï</button>
<h2 style="font-size:1.8rem; margin-bottom:16px;">–í–°–¢–£–ü–ò–¢–¨ –í BOX1V1</h2>
<p style="margin-bottom:24px; font-size:15px;">–ß—Ç–æ–±—ã –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É, –æ—Å—Ç–∞–≤—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–¥ –ª—é–±—ã–º –ø–æ—Å—Ç–æ–º —Å —Ö–µ—à—Ç–µ–≥–æ–º #BOX–£–ß–ê–°–¢–í–û–í–ê–¢–¨.</p>
<button class="btn btn-primary" style="width:100%; padding:20px;" onclick="window.open('https://t.me/streetbox1v1')">–û—Ç–∫—Ä—ã—Ç—å Telegram</button>
</div>
</div>

<!-- RULES MODAL -->
<div class="modal-overlay" id="rulesModal" onclick="closeModal('rulesModal')" role="dialog" aria-modal="true">
<div class="modal-content" style="max-width: 600px;" onclick="event.stopPropagation()">
<button class="modal-close" onclick="closeModal('rulesModal')">‚úï</button>
<h2 style="font-size:1.8rem; margin-bottom:24px;">–†–ï–ì–õ–ê–ú–ï–ù–¢</h2>
<div style="display:flex; flex-direction:column; gap:16px;">
<div style="padding-bottom:12px; border-bottom:1px solid var(--border);">
<strong style="text-transform:uppercase; font-size:12px; display:block; margin-bottom:4px; color:var(--accent-dark)">01. –§–æ—Ä–º–∞—Ç</strong>
<p style="font-size:15px; color:var(--text); font-weight:500;">–ú–∞—Ç—á–∏ 1 –Ω–∞ 1 —Å —É—á–∞—Å—Ç–∏–µ–º –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ –≤—Ä–∞—Ç–∞—Ä—è.</p>
</div>
<div style="padding-bottom:12px; border-bottom:1px solid var(--border);">
<strong style="text-transform:uppercase; font-size:12px; display:block; margin-bottom:4px; color:var(--accent-dark)">02. –¢–∞–π–º–∏–Ω–≥</strong>
<p style="font-size:15px; color:var(--text); font-weight:500;">–õ–∏–º–∏—Ç –Ω–∞ –∞—Ç–∞–∫—É ‚Äî 20 —Å–µ–∫—É–Ω–¥.</p>
</div>
<div style="padding-bottom:12px; border-bottom:1px solid var(--border);">
<strong style="text-transform:uppercase; font-size:12px; display:block; margin-bottom:4px; color:var(--accent-dark)">03. –†–µ–∑—É–ª—å—Ç–∞—Ç</strong>
<p style="font-size:15px; color:var(--text); font-weight:500;">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–≥—Ä—ã –¥–æ –¥–≤—É—Ö –≥–æ–ª–æ–≤, –±–µ–∑ –Ω–∏—á—å–∏.</p>
</div>
</div>
</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
/**
* CONFIG & STATE
*/
const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vREjbeB6jNrU01kw1npVtFTvqGdP134ERjmyROoOYeYXbzjgL0ZCNK6KwF0VTk3c1yxZEZEUsJjy2Ur/pub?output=csv';
const TARGET_DATE = new Date("March 1, 2026 00:00:00").getTime();
let allPlayers = [];
let currentRoleFilter = '–í—Å–µ';
let renderTimeout;

/**
 * DICTIONARY FOR UX
 */
const statDefs = {
  'DRI': '–¢–µ—Ö–Ω–∏–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –º—è—á–∞ –∏ –≤–µ–¥–µ–Ω–∏—è –¥—Ä–∏–±–ª–∏–Ω–≥–∞',
  'SPD': '–°—Ç–∞—Ä—Ç–æ–≤—ã–π —Ä—ã–≤–æ–∫ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è',
  'SHT': '–ú–æ—â–Ω–æ—Å—Ç—å –∏ —Ç–æ—á–Ω–æ—Å—Ç—å –∑–∞–≤–µ—Ä—à–∞—é—â–µ–≥–æ —É–¥–∞—Ä–∞',
  'PHY': '–§–∏–∑–∏—á–µ—Å–∫–∞—è –º–æ—â—å, –±–æ—Ä—å–±–∞ –∏ –∞—Ç–ª–µ—Ç–∏–∑–º',
  'REF': '–ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —É–¥–∞—Ä—ã –≤ —É–ø–æ—Ä',
  'DIV': '–î–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä—ã–∂–∫–∞ –∏ –æ—Ö–≤–∞—Ç —Å—Ç–≤–æ—Ä–∞ –≤–æ—Ä–æ—Ç',
  'HAN': '–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∏ –æ—Ç—Ä–∞–∂–µ–Ω–∏—è –º—è—á–∞',
  'POS': '–ì—Ä–∞–º–æ—Ç–Ω—ã–π –≤—ã–±–æ—Ä –ø–æ–∑–∏—Ü–∏–∏ –≤ —Å—Ç–≤–æ—Ä–µ –≤–æ—Ä–æ—Ç'
};

/**
* TOAST SYSTEM
*/
function showToast(message, duration = 3000) {
  const container = document.getElementById('toast-container');
  const toast = document.createElement('div');
  toast.className = 'toast';
  toast.innerHTML = `
    <span>${message}</span>
    <button class="toast-close" onclick="this.parentElement.classList.add('toast-out'); setTimeout(() => this.parentElement.remove(), 300)">√ó</button>
  `;
  container.appendChild(toast);
  
  setTimeout(() => {
    if (toast.parentElement) {
      toast.classList.add('toast-out');
      setTimeout(() => toast.remove(), 500);
    }
  }, duration);
}

/**
* INITIALIZATION
*/
async function init() {
  try {
    const res = await fetch(CSV_URL);
    if (!res.ok) throw new Error("Network response was not ok");
    const text = await res.text();
    allPlayers = parseCSV(text);
    if (allPlayers.length === 0) {
      showToast("–†–æ—Å—Ç–µ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ –ø—É—Å—Ç");
    }
    renderRoster();
    renderStats();
    handleHashAndDeepLink();
    setInterval(updateTimer, 1000);
    updateTimer();
    
    // Preloader timeout fallback
    setTimeout(() => {
      document.getElementById('preloader').classList.add('loaded');
    }, 1500);
  } catch (e) {
    console.error("Load Error", e);
    showToast("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö");
    document.getElementById('preloader').classList.add('loaded');
  }
}

function parseCSV(text) {
  const rows = text.replace(/\r/g, '').split('\n').filter(r => r.trim());
  return rows.slice(1).map(row => {
    const matches = row.match(/(".*?"|[^",\n]+)(?=\s*,|\s*$)/g);
    const c = matches ? matches.map(m => m.replace(/^"|"$/g, '').trim()) : [];
    return {
      name: c[0] || '',
      ovr: parseInt(c[1]) || 0,
      role: c[2] || '–ò–≥—Ä–æ–∫',
      drib: parseInt(c[3]) || 0,
      speed: parseInt(c[4]) || 0,
      shot: parseInt(c[5]) || 0,
      phys: parseInt(c[6]) || 0,
      photo: c[7] || 'https://images.unsplash.com/photo-1505506874110-6a7a69069a08?w=400&h=600&fit=crop&crop=face',
      status: c[8] || '',
      badges: c[9] ? c[9].split('|').map(b => b.trim()) : []
    };
  }).filter(p => p.name);
}

/**
* NAVIGATION & HASH LOGIC
*/
function handleHashAndDeepLink() {
  const fullHash = window.location.hash;
  if (!fullHash) return;
  
  const [hashPart, queryPart] = fullHash.split('?');
  const cleanHash = hashPart.replace('#', '');
  
  if (cleanHash && ['home', 'roster', 'stats'].includes(cleanHash)) {
    switchTab(cleanHash, false);
  }
  
  if (queryPart) {
    const params = new URLSearchParams(queryPart);
    const pNameFromUrl = params.get('player');
    if (pNameFromUrl) {
      const pName = pNameFromUrl.replace(/-/g, ' ');
      const found = allPlayers.find(x => x.name.toLowerCase() === pName.toLowerCase());
      if (found) setTimeout(() => openPlayerModal(found.name), 200);
    }
  }
}

function switchTab(id, updateHash = true) {
  const target = document.getElementById(id);
  if (!target) return;
  
  document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-links a').forEach(a => a.classList.remove('active'));
  
  target.classList.add('active');
  const btn = document.getElementById('btn-' + id);
  if (btn) btn.classList.add('active');
  
  if (updateHash) {
    window.history.pushState(null, null, `#${id}`);
  }
  
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

/**
* RENDERING
*/
function debouncedRender() {
  clearTimeout(renderTimeout);
  renderTimeout = setTimeout(renderRoster, 150);
}

function renderRoster() {
  const grid = document.getElementById('roster-grid');
  const search = document.getElementById('playerSearch').value.toLowerCase();
  
  const filtered = allPlayers.filter(p => {
    const mSearch = p.name.toLowerCase().includes(search);
    const mRole = currentRoleFilter === '–í—Å–µ' || p.role === currentRoleFilter;
    return mSearch && mRole;
  });

  if (filtered.length === 0) {
    grid.innerHTML = `
      <div style="grid-column: 1/-1; padding: 60px 20px; text-align: center; color: var(--text-dim); background: var(--bg-alt); border-radius: var(--radius);">
        <p style="font-size: 1.1rem; font-weight: 600; margin-bottom: 8px;">–ê—Ç–ª–µ—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
        <p style="font-size: 0.9rem;">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
      </div>
    `;
    return;
  }

  grid.innerHTML = filtered.map((p, i) => `
    <div class="card player-card"
      tabindex="0"
      role="button"
      aria-label="–ü—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞ ${p.name}, —Ä–µ–π—Ç–∏–Ω–≥ ${p.ovr}, —Ä–æ–ª—å ${p.role}${p.badges[0] ? ', ' + p.badges[0] : ''}"
      style="animation: fadeInUp 0.6s var(--cubic) both ${i * 0.03}s"
      onclick="openPlayerModal('${p.name}')"
      onkeydown="if(event.key==='Enter') openPlayerModal('${p.name}')">
      <div class="player-img" style="background-image: url('${p.photo}')" loading="lazy"></div>
      ${p.status ? `<div style="position:absolute; top:20px; right:20px; z-index:3; background:var(--accent); color:#000; font-size:10px; font-weight:900; padding:6px 12px; border-radius:10px; text-transform:uppercase;">${p.status}</div>` : ''}
      <div class="player-info">
        <span style="font-size:11px; font-weight:800; text-transform:uppercase; color:var(--accent); letter-spacing:0.1em;">${p.role}</span>
        <h3 style="font-size:1.8rem; margin: 8px 0; line-height:1.1;">${p.name}</h3>
        ${p.badges.length > 0 ? `<div style="font-size:10px; color:rgba(255,255,255,0.7); margin-top:4px; letter-spacing:0.05em;">${p.badges[0]}</div>` : ''}
        <div class="ovr-badge">OVR ${p.ovr}</div>
      </div>
    </div>
  `).join('');
}

function renderStats() {
  const sorted = [...allPlayers].sort((a, b) => b.ovr - a.ovr);
  document.getElementById('stats-body').innerHTML = sorted.map((p, i) => `
    <tr onclick="openPlayerModal('${p.name}')" style="cursor:pointer" tabindex="0" onkeydown="if(event.key==='Enter') openPlayerModal('${p.name}')" aria-label="–†–µ–π—Ç–∏–Ω–≥ ${p.ovr}, ${p.name}, ${p.role}${p.badges[0] ? ', ' + p.badges[0] : ''}">
      <td style="font-weight:900; color:var(--text-dim); width:60px;">${(i + 1).toString().padStart(2, '0')}</td>
      <td>
        <div style="display:flex; align-items:center; gap:16px;">
          <img src="${p.photo}" style="width:48px; height:48px; border-radius:12px; object-fit:cover;" alt="${p.name}" loading="lazy">
          <div>
            <div style="font-weight:900; text-transform:uppercase; font-style:italic; font-size:0.95rem;">${p.name}</div>
            <div style="font-size:10px; font-weight:700; color:var(--text-dim); text-transform:uppercase; margin-top:2px;">${p.role}</div>
          </div>
        </div>
      </td>
      <td style="text-align:right; width:120px;"><span class="ovr-badge" style="display:inline-block;">${p.ovr}</span></td>
    </tr>
  `).join('');
}

/**
* MODAL LOGIC & ACCESSIBILITY
*/
let lastFocusedElement;

function openModal(id) {
  lastFocusedElement = document.activeElement;
  const modal = document.getElementById(id);
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
  
  setTimeout(() => {
    const firstInput = modal.querySelector('button, input, [tabindex="0"]');
    if (firstInput) firstInput.focus();
  }, 100);
  
  modal.addEventListener('keydown', trapFocus);
}

function closeModal(id) {
  const modal = document.getElementById(id);
  if (!modal) return;
  
  modal.classList.remove('active');
  document.body.style.overflow = '';
  modal.removeEventListener('keydown', trapFocus);
  
  if (id === 'playerModal') {
    const currentTab = document.querySelector('section.active').id;
    window.history.replaceState(null, null, `#${currentTab}`);
  }
  
  if (lastFocusedElement) lastFocusedElement.focus();
}

function trapFocus(e) {
  if (e.key !== 'Tab') return;
  
  const focusableEls = this.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
  const first = focusableEls[0];
  const last = focusableEls[focusableEls.length - 1];
  
  if (e.shiftKey) {
    if (document.activeElement === first) {
      last.focus();
      e.preventDefault();
    }
  } else {
    if (document.activeElement === last) {
      first.focus();
      e.preventDefault();
    }
  }
}

window.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    const activeModal = document.querySelector('.modal-overlay.active');
    if (activeModal) closeModal(activeModal.id);
  }
});

function openPlayerModal(name) {
  const p = allPlayers.find(x => x.name.toLowerCase() === name.toLowerCase());
  if (!p) {
    showToast("–ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω");
    return;
  }

  document.getElementById('m-name').innerText = p.name;
  document.getElementById('m-role').innerText = p.role;
  document.getElementById('m-ovr').innerText = p.ovr;
  document.getElementById('m-img').src = p.photo;
  document.getElementById('m-badges').innerHTML = p.badges.map(b => 
    `<span style="font-size:10px; background:rgba(0,0,0,0.9); color:#fff; padding:4px 10px; border-radius:8px; font-weight:800;">${b}</span>`
  ).join('');

  const isGK = p.role === '–í—Ä–∞—Ç–∞—Ä—å';
  const stats = [
    { l: isGK ? 'REF' : 'DRI', v: p.drib },
    { l: isGK ? 'DIV' : 'SPD', v: p.speed },
    { l: isGK ? 'HAN' : 'SHT', v: p.shot },
    { l: isGK ? 'POS' : 'PHY', v: p.phys }
  ];

  document.getElementById('m-stats').innerHTML = stats.map(s => `
    <div class="stat-item">
      <div style="display:flex; justify-content:space-between; margin-bottom:12px;">
        <div class="stat-header" data-tip="${statDefs[s.l]}">
          <span style="font-size:12px; font-weight:900;">${s.l}</span>
          <i class="info-icon">?</i>
        </div>
        <span style="font-size:12px; font-weight:900;">${s.v}</span>
      </div>
      <div style="height:4px; background:var(--bg-alt); border-radius:2px; overflow:hidden;">
        <div style="width:0%; height:100%; background:var(--text); transition:1.2s var(--cubic) 0.3s;" id="bar-${s.l}"></div>
      </div>
    </div>
  `).join('');

  openModal('playerModal');

  setTimeout(() => {
    stats.forEach(s => {
      const bar = document.getElementById(`bar-${s.l}`);
      if (bar) bar.style.width = s.v + '%';
    });
  }, 100);

  const currentTab = document.querySelector('section.active').id;
  const playerSlug = p.name.replace(/\s+/g, '-').toLowerCase();
  window.history.replaceState(null, null, `#${currentTab}?player=${playerSlug}`);
}

/**
* ACTIONS
*/
function setRoleFilter(role, btn) {
  currentRoleFilter = role;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderRoster();
}

function toggleMenu() {
  const drawer = document.getElementById('mobile-drawer');
  const overlay = document.getElementById('drawer-overlay');
  const burger = document.getElementById('burger');
  const isOpen = drawer.classList.toggle('open');
  
  overlay.classList.toggle('open');
  burger.classList.toggle('open');
  burger.setAttribute('aria-expanded', isOpen);
  
  document.body.style.overflow = isOpen ? 'hidden' : '';
}

function handleMobileNav(id, isModal = false) {
  toggleMenu();
  setTimeout(() => isModal ? openModal(id) : switchTab(id), 300);
}

function sharePlayer() {
  const name = document.getElementById('m-name').innerText;
  const url = window.location.href;
  
  if (navigator.share) {
    navigator.share({
      title: `BOX1V1 | ${name}`,
      text: `–ö–∞—Ä—Ç–æ—á–∫–∞ –∞—Ç–ª–µ—Ç–∞ ${name} –≤ —Å–∏—Å—Ç–µ–º–µ BOX1V1! üî•`,
      url: url
    }).catch(() => {});
  } else {
    navigator.clipboard.writeText(url);
    showToast('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä');
  }
}

/**
* –ì–ï–ù–ï–†–ê–¶–ò–Ø –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø –ö–ê–†–¢–û–ß–ö–ò
*/
async function downloadPlayerCard() {
  const modalContent = document.querySelector('#playerModal .modal-content');
  const name = document.getElementById('m-name').innerText;
  
  // –°–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  const actionButtons = modalContent.querySelector('div[style*="margin-top:32px"]');
  const closeBtn = modalContent.querySelector('.modal-close');
  
  const originalOpacity = {
    buttons: actionButtons.style.opacity,
    close: closeBtn.style.opacity
  };
  
  actionButtons.style.opacity = '0';
  closeBtn.style.opacity = '0';

  showToast("–°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É...");

  try {
    const canvas = await html2canvas(modalContent, {
      useCORS: true,
      scale: 2,
      backgroundColor: "#ffffff",
      borderRadius: 32,
      removeContainer: true,
      onclone: (clonedDoc) => {
        const content = clonedDoc.querySelector('.modal-content');
        content.style.transform = 'none';
        content.style.boxShadow = 'none';
        content.style.border = '1px solid #eee';
        
        // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–ª–æ–Ω–µ
        const clonedButtons = clonedDoc.querySelector('div[style*="margin-top:32px"]');
        const clonedClose = clonedDoc.querySelector('.modal-close');
        if (clonedButtons) clonedButtons.remove();
        if (clonedClose) clonedClose.remove();
      }
    });

    // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
    const link = document.createElement('a');
    const fileName = `BOX1V1_${name.replace(/\s+/g, '_')}_${Date.now()}.png`;
    link.download = fileName;
    link.href = canvas.toDataURL("image/png");
    link.click();
    
    showToast("–ö–∞—Ä—Ç–æ—á–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!");
  } catch (err) {
    console.error("Render error:", err);
    showToast("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–æ—Ç–æ");
  } finally {
    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å –∫–Ω–æ–ø–æ–∫
    actionButtons.style.opacity = originalOpacity.buttons || '1';
    closeBtn.style.opacity = originalOpacity.close || '1';
  }
}

function updateTimer() {
  const now = Date.now();
  const diff = TARGET_DATE - now;
  const timerEl = document.getElementById('timer');
  
  if (diff <= 0) {
    document.getElementById('timer-status').innerText = "–°–µ–∑–æ–Ω –æ—Ç–∫—Ä—ã—Ç!";
    if (timerEl) timerEl.style.display = 'none';
    return;
  }
  
  document.getElementById('days').innerText = Math.floor(diff / 864e5).toString().padStart(2, '0');
  document.getElementById('hours').innerText = Math.floor((diff % 864e5) / 36e5).toString().padStart(2, '0');
  document.getElementById('mins').innerText = Math.floor((diff % 36e5) / 6e4).toString().padStart(2, '0');
  document.getElementById('secs').innerText = Math.floor((diff % 6e4) / 1000).toString().padStart(2, '0');
}

// Handle browser history
window.addEventListener('popstate', handleHashAndDeepLink);

// Handle scroll
window.addEventListener('scroll', () => {
  document.body.classList.toggle('scrolled', window.scrollY > 50);
});

// Initialize on load
window.onload = init;
</script>
</body>
</html>
